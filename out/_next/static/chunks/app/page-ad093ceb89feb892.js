(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:()=>{},2061:()=>{},4856:(e,t,a)=>{Promise.resolve().then(a.bind(a,8804))},8804:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var r=a(7437),o=a(2265),n=a(7800);function l(e){if(!e)return"";let t=e.trim(),a=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/사이즈\s*:\s*/g,"")).replace(/컬러\s*:\s*/g,"")).replace(/색상\s*:\s*/g,"")).replace(/사이즈\s*선택\s*:\s*/g,"")).replace(/컬러\s*선택\s*:\s*/g,"")).replace(/색상\s*선택\s*:\s*/g,"")).replace(/길이\s*선택\s*:\s*/g,"")).replace(/\([^)]*\)/g,"")).replace(/\b[Oo]ne\s*[Ss]ize\b/g,"")).replace(/\s+/g," ").trim()).replace(/\//g,",")).split(",").map(e=>e.trim());if(a.length>=2)return a.filter(e=>e).join(",");{let e=a[0];return/^[SMLX]+$/i.test(e)?e.toUpperCase():e}}async function s(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{try{let a=new Uint8Array(e.target.result),r=n.ij(a,{type:"array"}),o=r.SheetNames[0],s=r.Sheets[o],c=n.P6.sheet_to_json(s,{header:1}),i=-1;for(let e=0;e<Math.min(10,c.length);e++)if(c[e].map(e=>String(e||"").toLowerCase()).some(e=>e.includes("주문번호")||e.includes("상품명")||e.includes("고객명"))){i=e;break}if(-1===i)throw Error("유효한 헤더를 찾을 수 없습니다. 엑셀 형식을 확인해주세요.");let d=c[i],m=e=>d.findIndex(t=>"string"==typeof t&&t.toLowerCase().includes(e.toLowerCase())),u=(e,t)=>{for(let a of t){let t=m(a);if(-1!==t&&e[t])return String(e[t])}return""},p=[];for(let e=i+1;e<c.length;e++){let t=c[e];if(!t||0===t.length)continue;let a=u(t,["주문번호","주문 번호","주문no","주문 no","order","오더 번호"]),r=u(t,["상품명","품명","item","제품명","상품 명"]);if(!a||!r)continue;let o=u(t,["옵션명","옵션","옵션정보","옵션 정보","선택 옵션","옵션 내역"]),n=l(o),s={id:function(e,t,a,r){let o=(e||"").toString().trim(),n=(t||"").toString().trim(),l=(a||"").toString().trim(),s=Date.now(),c=Math.floor(1e4*Math.random());return"".concat(o,"_").concat(n.substring(0,10),"_").concat(l.substring(0,5),"_").concat(r,"_").concat(s,"_").concat(c)}(a,r,n,parseInt(u(t,["수량","주문수량","입고수량","반품수량","quantity"]),10)||1),orderNumber:a,customerName:u(t,["고객명","주문자","구매자","customer","구매자명","고객 이름"]),productName:r,optionName:n,quantity:parseInt(u(t,["수량","주문수량","입고수량","반품수량","quantity"]),10)||1,returnReason:u(t,["반품사유","반품 사유","사유","메모","반품메모","반품 메모"]),returnTrackingNumber:u(t,["반품송장번호","반품운송장","반품 송장","반품송장","송장번호","송장"]),pickupTrackingNumber:u(t,["수거송장번호","수거운송장","수거 송장","수거송장","픽업송장번호","픽업 송장번호"]),status:"PENDING",barcode:"",zigzagProductCode:u(t,["자체상품코드","지그재그코드","상품코드"]),customProductCode:u(t,["자체상품코드","지그재그코드","상품코드"])};p.push(s)}console.log("".concat(p.length,"개의 반품 항목이 추출되었습니다.")),t(p)}catch(e){console.error("엑셀 파싱 오류:",e),a(Error("엑셀 파일을 처리하는 중 오류가 발생했습니다."))}},r.onerror=()=>{a(Error("엑셀 파일을 읽는 중 오류가 발생했습니다."))},r.readAsArrayBuffer(e)})}function c(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{try{if(!e.target||!e.target.result)throw Error("파일 데이터를 읽을 수 없습니다.");let a=new Uint8Array(e.target.result),r=n.ij(a,{type:"array"});if(!r||!r.SheetNames||0===r.SheetNames.length)throw Error("엑셀 파일에 시트가 없습니다.");let o=r.Sheets[r.SheetNames[0]];if(!o)throw Error("엑셀 시트를 읽을 수 없습니다.");let s=n.P6.sheet_to_json(o,{header:1});if(!s||0===s.length)throw Error("엑셀 파일에 데이터가 없습니다.");console.log("엑셀 데이터 로드 완료:",{행수:s.length,첫번째행:s[0]});let c=function(e){for(let t=0;t<Math.min(10,e.length);t++){let a=e[t];if(a&&["상품명","바코드","옵션"].reduce((e,t)=>a.some(e=>"string"==typeof e&&e.includes&&e.includes(t))?e+1:e,0)>=2)return t}return -1}(s);if(-1===c)throw Error("상품 데이터 헤더 행을 찾을 수 없습니다.");let i=s[c].map(e=>String(e||"").trim()),d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=i.findIndex(t=>t===e);if(-1===a&&(a=i.findIndex(t=>t.includes(e))),-1===a&&t.length>0){for(let e of t)if(a=i.findIndex(t=>t===e),-1!==a||(a=i.findIndex(t=>t.includes(e)),-1!==a))break}return a},m=d("상품명",["제품명","품명"]),u=d("바코드번호",["바코드"]),p=d("옵션명",["옵션","옵션정보"]),h=d("사입상품명",["사입명","매입상품명"]),g=d("자체상품코드",["지그재그코드","상품코드"]);if(-1===m||-1===u)throw Error("필수 열(상품명, 바코드번호)을 찾을 수 없습니다.");console.log("컬럼 인덱스:",{상품명:m,바코드번호:u,옵션명:p,사입상품명:h,자체상품코드:g});let x=[],b=new Map;for(let e=c+1;e<s.length;e++){let t=s[e];if(!t||0===t.length)continue;let a="";if(void 0!==t[u]&&null!==t[u]&&(a=String(t[u]).trim()),!a){console.warn("행 ".concat(e+1,": 바코드 없음, 건너뜀"));continue}if(b.has(a)){console.log("중복 바코드 무시: ".concat(a));continue}let r="";if(void 0!==t[m]&&null!==t[m]&&(r=String(t[m]).trim()),!r){console.warn("행 ".concat(e+1,": 상품명 없음, 건너뜀"));continue}let o="";if(-1!==p&&void 0!==t[p]&&null!==t[p]){let e=String(t[p]);o=l(e)}let n="";-1!==h&&void 0!==t[h]&&null!==t[h]&&(n=String(t[h]).trim());let c="",i="";-1!==g&&void 0!==t[g]&&null!==t[g]&&(i=c=String(t[g]).trim());let d={id:function(e,t){let a=(e||"").toString().trim(),r=(t||"").toString().trim(),o=Date.now(),n=Math.floor(1e4*Math.random());return"".concat(a,"_").concat(r.substring(0,10),"_").concat(o,"_").concat(n)}(a,r),productName:r,barcode:a,optionName:o,purchaseName:n||"",zigzagProductCode:c,customProductCode:i};b.set(a,!0),x.push(d)}console.log("".concat(x.length,"개의 상품 데이터가 추출되었습니다.")),t(x)}catch(e){console.error("엑셀 파싱 오류:",e),a(Error("엑셀 파일을 처리하는 중 오류가 발생했습니다."))}},r.onerror=()=>{a(Error("엑셀 파일을 읽는 중 오류가 발생했습니다."))},r.readAsArrayBuffer(e)})}var i=a(2533);let d=e=>{let{isOpen:t,onClose:a,children:n,modalId:l}=e,s=(0,o.useRef)(l||"modal-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))),c=(0,o.useRef)(null);return((0,o.useEffect)(()=>(t?("undefined"!=typeof document&&(document.body.style.overflow="hidden"),setTimeout(()=>{if(c.current){let e=c.current.querySelector("textarea"),t=c.current.querySelector("input"),a=c.current.querySelector('button, [tabindex]:not([tabindex="-1"]), input, select, textarea, a[href]');e?e.focus():t?t.focus():a&&a.focus()}},100)):"undefined"!=typeof document&&(document.body.style.overflow=""),()=>{"undefined"!=typeof document&&(document.body.style.overflow="")}),[t]),(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a()};return t&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,a]),t)?(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",onClick:e=>{e.target===e.currentTarget&&a()},style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1e4},role:"dialog","aria-modal":"true","data-modal-id":s.current,children:(0,r.jsx)("div",{className:"relative",ref:c,tabIndex:-1,style:{maxWidth:"var(--popup-width)",maxHeight:"var(--popup-height)",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:n})}):null},m=e=>{let{isOpen:t,onClose:a,onSave:n,returnItem:l,detailReason:s,setDetailReason:c,zIndex:i}=e,[m,u]=(0,o.useState)(s);return((0,o.useEffect)(()=>{u(s)},[s]),t&&l)?(0,r.jsx)(d,{isOpen:t,onClose:a,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 max-w-xl",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 p-4 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"반품 사유 상세"}),(0,r.jsx)("button",{onClick:a,className:"text-white hover:text-gray-200",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(m),n(m)},className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6 grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"주문 정보"}),(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"고객명:"})," ",l.customerName]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"주문번호:"})," ",l.orderNumber]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"상품 정보"}),(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"상품명:"})," ",l.productName]}),l.optionName&&(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"옵션:"})," ",l.optionName]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"수량:"})," ",l.quantity]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"반품 사유"}),(0,r.jsx)("div",{className:"bg-pink-50 p-3 rounded-lg border border-pink-200 text-red-800",children:l.returnReason})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"detailReason",className:"block text-sm font-medium text-gray-700",children:"상세 사유"}),(0,r.jsx)("textarea",{id:"detailReason",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4,value:m,onChange:e=>u(e.target.value),placeholder:"반품 상세 사유를 입력하세요"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"취소"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"저장"})]})]})]})}):null};var u=a(4887);class p{static getInstance(){return p.instance||(p.instance=new p),p.instance}createModalContainer(){if(!this.isClient||"undefined"==typeof document)return;let e=document.getElementById("global-modal-container");e&&e.remove(),this.modalContainer=document.createElement("div"),this.modalContainer.id="global-modal-container",this.modalContainer.style.position="fixed",this.modalContainer.style.top="0",this.modalContainer.style.left="0",this.modalContainer.style.width="100%",this.modalContainer.style.height="100%",this.modalContainer.style.pointerEvents="none",this.modalContainer.style.zIndex="10000",document.body.appendChild(this.modalContainer)}addModal(e,t){this.isClient&&"undefined"!=typeof document&&(this.modalContainer||this.createModalContainer(),this.removeModal(e),this.activeModals.add(e),this.modalElements.set(e,t),this.modalContainer&&(this.modalContainer.appendChild(t),t.style.pointerEvents="auto",console.log("모달 추가: ".concat(e,", 총 모달 수: ").concat(this.activeModals.size))))}removeModal(e){if(!this.isClient)return;let t=this.modalElements.get(e);t&&t.parentNode&&t.parentNode.removeChild(t),this.activeModals.delete(e),this.modalElements.delete(e),console.log("모달 제거: ".concat(e,", 남은 모달 수: ").concat(this.activeModals.size))}bringToFront(e){if(!this.isClient)return;let t=this.modalElements.get(e);t&&this.modalContainer&&(this.modalContainer.appendChild(t),console.log("모달 최상위로 이동: ".concat(e)))}getActiveModals(){return Array.from(this.activeModals)}clearAll(){this.isClient&&(this.activeModals.clear(),this.modalElements.clear(),this.modalContainer&&(this.modalContainer.innerHTML=""))}constructor(){this.modalContainer=null,this.activeModals=new Set,this.modalElements=new Map,this.isClient=!1,this.isClient=!0,this.createModalContainer()}}let h=null,g=()=>(h||(h=p.getInstance()),h),x=(e,t)=>{g().addModal(e,t)},b=e=>{g().removeModal(e)},N=e=>{let{children:t,isOpen:a,onClose:n,zIndex:l}=e,s=(0,o.useRef)(null),c=(0,o.useRef)("modal-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)));if((0,o.useEffect)(()=>(a&&s.current&&(document.body.style.overflow="hidden",x(c.current,s.current),setTimeout(()=>{if(s.current){let e=s.current.querySelector('button, [tabindex]:not([tabindex="-1"]), input, select, textarea, a[href]');e?e.focus():s.current.focus()}},50)),()=>{"undefined"!=typeof document&&(document.body.style.overflow=""),a&&b(c.current)}),[a]),(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return a&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[a,n]),!a)return null;let i=(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",onClick:e=>{s.current&&!s.current.contains(e.target)&&n()},style:{position:"fixed",inset:0,zIndex:l||1e4},role:"dialog","aria-modal":"true",children:(0,r.jsx)("div",{className:"relative",ref:s,tabIndex:-1,style:{maxWidth:"95vw",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},children:t})});return(0,u.createPortal)(i,document.body)},f=e=>{let{isOpen:t,onClose:a,returnItem:n,onSave:l,zIndex:s}=e,[c,i]=(0,o.useState)((null==n?void 0:n.returnTrackingNumber)||"");return t?(0,r.jsx)(N,{isOpen:t,onClose:a,zIndex:s,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-96 max-w-full",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 p-4 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"반품송장번호 입력"}),(0,r.jsx)("button",{onClick:a,className:"text-white hover:text-gray-200",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"주문 정보"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 bg-gray-50 p-3 rounded border border-gray-200",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"고객명:"})," ",n.customerName]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"주문번호:"})," ",n.orderNumber]}),(0,r.jsxs)("div",{className:"text-sm sm:col-span-2",children:[(0,r.jsx)("span",{className:"font-medium",children:"상품명:"})," ",n.productName]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"반품 송장번호"}),(0,r.jsx)("input",{type:"text",value:c,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"송장번호를 입력하세요"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"취소"}),(0,r.jsx)("button",{type:"button",onClick:()=>{l(c)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"저장"})]})]})]})}):null},y=e=>{let{isOpen:t,onClose:a,returnItem:n,products:l,onMatch:s,zIndex:c}=e,[i,m]=(0,o.useState)(""),[u,p]=(0,o.useState)([]),[h,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&(m(""),p([]),g(!1))},[t]);let x=()=>{if(!i.trim()){p([]),g(!1);return}let e=i.toLowerCase().trim();p(l.filter(t=>t.productName&&t.productName.toLowerCase().includes(e)||t.purchaseName&&t.purchaseName.toLowerCase().includes(e))),g(!0)};return t?(0,r.jsx)(d,{isOpen:t,onClose:a,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 p-4 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"상품 매칭"}),(0,r.jsx)("button",{onClick:a,className:"text-white hover:text-gray-200",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"p-4 border-b",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-medium mb-2",children:"선택된 반품 항목"}),(0,r.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"상품명:"})," ",n.productName]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"주문번호:"})," ",n.orderNumber]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"고객명:"})," ",n.customerName]}),n.optionName&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"옵션:"})," ",n.optionName]})]})})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",className:"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:i,onChange:e=>{m(e.target.value)},placeholder:"상품명 또는 사입상품명으로 검색",onKeyPress:e=>{"Enter"===e.key&&x()}}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",onClick:x,children:"검색"})]})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:h?u.length>0?(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/3",children:"사입상품명"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"옵션명"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"바코드"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"매칭"})]})}),(0,r.jsx)("tbody",{children:u.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500 break-words",children:e.purchaseName||"-"}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:e.optionName||"-"}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-mono",children:e.barcode||"-"}),(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsx)("button",{onClick:()=>s(n,e),className:"text-blue-600 hover:text-blue-900 bg-blue-100 hover:bg-blue-200 px-3 py-1 rounded-full transition-colors",children:"매칭"})})]},e.id||t))})]}):(0,r.jsx)("div",{className:"p-8 text-center text-gray-500",children:(0,r.jsx)("p",{children:"검색 결과가 없습니다."})}):(0,r.jsx)("div",{className:"p-8 text-center text-gray-500",children:(0,r.jsx)("p",{children:"상품명 또는 사입상품명으로 검색하세요."})})}),(0,r.jsx)("div",{className:"bg-gray-50 p-4 flex justify-end",children:(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 bg-white rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none",children:"닫기"})})]})}):null},j=e=>{let{isOpen:t,onClose:a,items:o,selectedItems:n,onRefresh:l,onProcessSelected:s,onDeleteSelected:c,onRematchSelected:i,onItemSelect:m,PendingItemsTable:u}=e;return(0,r.jsx)(d,{isOpen:t,onClose:a,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full overflow-hidden flex flex-col",style:{maxWidth:"var(--popup-width)",maxHeight:"var(--popup-height)"},children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 p-4 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"입고전 반품 목록"}),(0,r.jsx)("button",{onClick:a,className:"text-white hover:text-gray-200",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-auto p-6",children:o&&o.length>0?(0,r.jsx)("div",{className:"overflow-x-auto max-h-[70vh]",children:(0,r.jsx)(u,{items:o})}):(0,r.jsx)("p",{className:"text-center text-gray-500 py-8",children:"대기 중인 반품이 없습니다."})}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 flex flex-wrap gap-2 justify-end",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",onClick:l,children:"새로고침"}),n.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-md transition-colors",onClick:s,children:["선택항목 입고처리 (",n.length,"개)"]}),(0,r.jsxs)("button",{className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md transition-colors",onClick:c,children:["선택항목 삭제 (",n.length,"개)"]})]}),n.length>0&&(0,r.jsxs)("button",{className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-md transition-colors",onClick:i,children:["재매칭 (",n.length,"개)"]}),(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md transition-colors",onClick:a,children:"닫기"})]})]})})},v=e=>{let{isOpen:t,onClose:a,selectedItems:n,products:l,onRematch:s}=e,[c,i]=(0,o.useState)(0),[m,u]=(0,o.useState)(""),[p,h]=(0,o.useState)([]),g=n[c];(0,o.useEffect)(()=>{m.trim()?h(l.filter(e=>{var t,a,r,o;return(null===(t=e.productName)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase()))||(null===(a=e.purchaseName)||void 0===a?void 0:a.toLowerCase().includes(m.toLowerCase()))||(null===(r=e.optionName)||void 0===r?void 0:r.toLowerCase().includes(m.toLowerCase()))||(null===(o=e.barcode)||void 0===o?void 0:o.toLowerCase().includes(m.toLowerCase()))}).slice(0,20)):h(l.slice(0,20))},[m,l]);let x=e=>{g&&(s(g.id,e.barcode),c<n.length-1?(i(c+1),u("")):(i(0),u(""),a()))},b=()=>{i(0),u(""),a()};return g?(0,r.jsx)(d,{isOpen:t,onClose:a,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 p-4 text-white",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold",children:["수동 재매칭 (",c+1,"/",n.length,")"]}),(0,r.jsx)("button",{onClick:b,className:"text-white hover:text-gray-200",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"재매칭할 반품 아이템:"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"구매자:"})," ",g.customerName]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"상품명:"})," ",g.purchaseName]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"옵션:"})," ",g.optionName]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"현재 바코드:"}),(0,r.jsx)("span",{className:"text-red-600 font-mono",children:g.barcode||"매칭 안됨"})]})]})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("input",{type:"text",placeholder:"상품명, 옵션명, 바코드로 검색...",value:m,onChange:e=>u(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),(0,r.jsxs)("div",{className:"overflow-y-auto max-h-[50vh]",children:[(0,r.jsxs)("table",{className:"w-full border-collapse",children:[(0,r.jsx)("thead",{className:"bg-gray-100 sticky top-0",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-2 text-left border",children:"바코드"}),(0,r.jsx)("th",{className:"p-2 text-left border",children:"상품명"}),(0,r.jsx)("th",{className:"p-2 text-left border",children:"사입상품명"}),(0,r.jsx)("th",{className:"p-2 text-left border",children:"옵션명"}),(0,r.jsx)("th",{className:"p-2 text-left border",children:"액션"})]})}),(0,r.jsx)("tbody",{children:p.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 border-b",children:[(0,r.jsx)("td",{className:"p-2 border font-mono text-sm",children:e.barcode}),(0,r.jsx)("td",{className:"p-2 border text-sm",children:e.productName}),(0,r.jsx)("td",{className:"p-2 border text-sm",children:e.purchaseName}),(0,r.jsx)("td",{className:"p-2 border text-sm",children:e.optionName}),(0,r.jsx)("td",{className:"p-2 border",children:(0,r.jsx)("button",{onClick:()=>x(e),className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm transition-colors",children:"선택"})})]},t))})]}),0===p.length&&(0,r.jsx)("p",{className:"text-center text-gray-500 py-4",children:"검색 결과가 없습니다."})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 flex justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{c>0&&(i(c-1),u(""))},disabled:0===c,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white rounded-md transition-colors",children:"이전"}),(0,r.jsx)("button",{onClick:()=>{c<n.length-1&&(i(c+1),u(""))},disabled:c===n.length-1,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white rounded-md transition-colors",children:"다음"})]}),(0,r.jsx)("button",{onClick:b,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md transition-colors",children:"닫기"})]})]})}):null},w=console.error,S=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];try{w(...t)}catch(e){}};function C(e,t){if(!e||!t)return 0;e=e.toLowerCase().trim(),t=t.toLowerCase().trim();let a=e.length,r=t.length;if(Math.abs(a-r)>.3*Math.min(a,r))return 0;let o=Array(a+1).fill(null).map(()=>Array(r+1).fill(0));for(let e=0;e<=a;e++)o[e][0]=e;for(let e=0;e<=r;e++)o[0][e]=e;for(let n=1;n<=a;n++)for(let a=1;a<=r;a++){let r=e[n-1]===t[a-1]?0:1;o[n][a]=Math.min(o[n-1][a]+1,o[n][a-1]+1,o[n-1][a-1]+r)}let n=Math.max(a,r);return 1-o[a][r]/n}function z(){let{returnState:e,dispatch:t}=(0,i.b)(),[a,d]=(0,o.useState)(!1),[u,p]=(0,o.useState)(""),h=(0,o.useRef)(null),g=(0,o.useRef)(null);(0,o.useRef)(null);let x=(0,o.useRef)(null);(0,o.useRef)(null),(0,o.useRef)(null);let[b,N]=(0,o.useState)(!1),[w,z]=(0,o.useState)(null),[R,k]=(0,o.useState)(""),[P,T]=(0,o.useState)([]),[E,D]=(0,o.useState)(!1),[L,F]=(0,o.useState)(null),[O,I]=(0,o.useState)([]),[_,M]=(0,o.useState)(!1),[A,U]=(0,o.useState)(null),[B,H]=(0,o.useState)(!1),[W,q]=(0,o.useState)(null),[J,K]=(0,o.useState)({testButton:"bg-blue-500 hover:bg-blue-600",firebaseButton:"bg-indigo-500 hover:bg-indigo-600",productButton:"bg-green-500 hover:bg-green-600",returnButton:"bg-blue-500 hover:bg-blue-600",productListButton:"bg-purple-500 hover:bg-purple-600",pendingButton:"bg-yellow-500 hover:bg-yellow-600",downloadButton:"bg-teal-500 hover:bg-teal-600",trackingButton:"bg-blue-500 hover:bg-blue-600"}),[G,V]=(0,o.useState)(!1),[Y,X]=(0,o.useState)(null),[$,Q]=(0,o.useState)(!1),[Z,ee]=(0,o.useState)(!1),[et,ea]=(0,o.useState)(!1),[er,eo]=(0,o.useState)(""),[en,el]=(0,o.useState)(!1),[es,ec]=(0,o.useState)({popupWidth:81,popupHeight:67.5,popupTableFontSize:1,popupBarcodeFontSize:.7,popupCellPadding:.5,popupLineHeight:1.2,mainTableFontSize:1,mainBarcodeFontSize:.7,mainCellPadding:.75,mainLineHeight:1.2,columnAlignment:{customerName:"center",orderNumber:"center",productName:"left",optionName:"center",quantity:"center",returnReason:"left",trackingNumber:"center",barcode:"left",actions:"center"},columnWidths:{customerName:120,orderNumber:100,productName:200,optionName:120,quantity:30,returnReason:80,trackingNumber:120,barcode:180,actions:30},autoTextSize:{enabled:!0,minFontSize:.6,maxFontSize:1.2,adjustForOverflow:!0},barcodeFormat:{enabled:!0,mainCodeSize:1.1,subInfoSize:.7,lineHeight:1.1}});(0,o.useCallback)((e,t)=>(S("[".concat(t,"] 오류:"),e),p("".concat(t," 중 오류가 발생했습니다: ").concat(e instanceof Error?e.message:"알 수 없는 오류")),null),[]);let ei=()=>{try{localStorage.getItem("returnData")&&(console.log("기존 returnData 정리 중..."),localStorage.removeItem("returnData"));let e=e=>{let t=localStorage.getItem(e);if(!t)return[];try{if(t.includes('"pN"')||t.includes('"oN"')||t.includes('"cN"'))return em(t);return JSON.parse(t)}catch(t){return console.error("".concat(e," 데이터 로드 오류:"),t),[]}},a=e("pendingReturns"),r=e("completedReturns"),o=e("products"),n=localStorage.getItem("lastUpdated");(a.length>0||r.length>0||o.length>0)&&(t({type:"SET_RETURNS",payload:{pendingReturns:a,completedReturns:r,products:o}}),p("마지막 업데이트: ".concat(new Date(n||"").toLocaleString())))}catch(e){console.error("로컬 데이터 로드 오류:",e),p("로컬 데이터를 불러오는 중 오류가 발생했습니다.")}},ed=e=>{try{return JSON.stringify(e).replace(/("productName")/g,'"pN"').replace(/("optionName")/g,'"oN"').replace(/("customerName")/g,'"cN"').replace(/("returnReason")/g,'"rR"').replace(/("barcode")/g,'"bc"').replace(/("quantity")/g,'"qty"').replace(/("zigzagProductCode")/g,'"zpc"').replace(/("purchaseName")/g,'"pnm"')}catch(t){return console.error("데이터 압축 오류:",t),JSON.stringify(e)}},em=e=>{try{let t=e.replace(/("pN")/g,'"productName"').replace(/("oN")/g,'"optionName"').replace(/("cN")/g,'"customerName"').replace(/("rR")/g,'"returnReason"').replace(/("bc")/g,'"barcode"').replace(/("qty")/g,'"quantity"').replace(/("zpc")/g,'"zigzagProductCode"').replace(/("pnm")/g,'"purchaseName"');return JSON.parse(t)}catch(t){return console.error("데이터 압축 해제 오류:",t),JSON.parse(e)}},eu=e=>{try{let t=(e,t)=>{try{let a=ed(t);return localStorage.setItem(e,a),!0}catch(a){if("QuotaExceededError"===a.name){if(console.warn("".concat(e," 저장 실패 - 할당량 초과, 데이터 크기 줄이기 시도")),Array.isArray(t)&&t.length>100){let a=t.slice(-100);try{let r=ed(a);return localStorage.setItem(e,r),console.log("".concat(e," 데이터 크기 축소 저장 성공 (").concat(t.length," -> ").concat(a.length,")")),!0}catch(t){console.error("".concat(e," 축소 저장도 실패:"),t)}}return!1}throw a}},a=t("pendingReturns",e.pendingReturns||[]),r=t("completedReturns",e.completedReturns||[]),o=t("products",e.products||[]);return localStorage.setItem("lastUpdated",new Date().toISOString()),a&&r&&o||p("일부 데이터가 크기 제한으로 인해 축소 저장되었습니다."),!0}catch(e){return console.error("로컬 스토리지 저장 오류:",e),p("데이터 저장 중 오류가 발생했습니다. 브라우저 저장공간을 확인해주세요."),!1}},ep=(0,o.useCallback)(()=>{try{eu(e),console.log("로컬 데이터 자동 저장 완료")}catch(e){console.error("자동 저장 실패:",e)}},[e]);(0,o.useEffect)(()=>{if(e.pendingReturns.length>0||e.completedReturns.length>0||e.products.length>0){let e=setTimeout(()=>{ep()},1e3);return()=>clearTimeout(e)}},[e,ep]);let eh=()=>{try{let e=0;for(let t in localStorage)localStorage.hasOwnProperty(t)&&(e+=localStorage[t].length);e>5242880&&(console.log("로컬 스토리지 용량 정리 시작..."),["returnData","returnData_backup"].forEach(e=>{localStorage.getItem(e)&&(localStorage.removeItem(e),console.log("".concat(e," 삭제됨")))}),p("로컬 스토리지 정리 완료"))}catch(e){console.error("스토리지 정리 오류:",e)}};(0,o.useEffect)(()=>{eh(),ei(),localStorage.getItem("pendingReturns")||localStorage.getItem("completedReturns")||p("로컬 저장소에서 데이터를 불러왔습니다. 엑셀 파일을 업로드하여 시작하세요.")},[]),(0,o.useEffect)(()=>{let e=localStorage.getItem("buttonColors");if(e)try{K(JSON.parse(e))}catch(e){console.error("색상 설정 로드 오류:",e)}},[]),(0,o.useEffect)(()=>{let e=localStorage.getItem("tableSettings");if(e)try{let t=JSON.parse(e),a={popupWidth:81,popupHeight:67.5,popupTableFontSize:1,popupBarcodeFontSize:.7,popupCellPadding:.5,popupLineHeight:1.2,mainTableFontSize:1,mainBarcodeFontSize:.7,mainCellPadding:.75,mainLineHeight:1.2,columnAlignment:{customerName:"center",orderNumber:"center",productName:"left",optionName:"center",quantity:"center",returnReason:"left",trackingNumber:"center",barcode:"left",actions:"center"},columnWidths:{customerName:120,orderNumber:100,productName:200,optionName:120,quantity:30,returnReason:80,trackingNumber:120,barcode:180,actions:30},autoTextSize:{enabled:!0,minFontSize:.6,maxFontSize:1.2,adjustForOverflow:!0},barcodeFormat:{enabled:!0,mainCodeSize:1.1,subInfoSize:.7,lineHeight:1.1},...t};ec(a);let r=document.documentElement;r.style.setProperty("--popup-width","".concat(a.popupWidth,"vw")),r.style.setProperty("--popup-height","".concat(a.popupHeight,"vh")),r.style.setProperty("--popup-table-font-size","".concat(a.popupTableFontSize,"rem")),r.style.setProperty("--popup-barcode-font-size","".concat(a.popupBarcodeFontSize,"rem")),r.style.setProperty("--popup-cell-padding","".concat(a.popupCellPadding,"rem")),r.style.setProperty("--popup-line-height",a.popupLineHeight.toString()),r.style.setProperty("--main-table-font-size","".concat(a.mainTableFontSize,"rem")),r.style.setProperty("--main-barcode-font-size","".concat(a.mainBarcodeFontSize,"rem")),r.style.setProperty("--main-cell-padding","".concat(a.mainCellPadding,"rem")),r.style.setProperty("--main-line-height",a.mainLineHeight.toString()),a.columnAlignment&&Object.entries(a.columnAlignment).forEach(e=>{let[t,a]=e;r.style.setProperty("--column-".concat(t,"-alignment"),a)}),a.columnWidths&&Object.entries(a.columnWidths).forEach(e=>{let[t,a]=e;r.style.setProperty("--column-".concat(t,"-width"),"".concat(a,"px"))}),a.autoTextSize&&Object.entries(a.autoTextSize).forEach(e=>{let[t,a]=e;r.style.setProperty("--auto-text-size-".concat("enabled"===t?"enabled":"minFontSize"===t?"minFontSize":"maxFontSize"===t?"maxFontSize":"adjustForOverflow"===t?"adjustForOverflow":t),String(a))}),a.barcodeFormat&&Object.entries(a.barcodeFormat).forEach(e=>{let[t,a]=e;r.style.setProperty("--barcode-format-".concat("enabled"===t?"enabled":"mainCodeSize"===t?"mainCodeSize":"subInfoSize"===t?"subInfoSize":"lineHeight"===t?"lineHeight":t),String(a))})}catch(e){console.error("표 설정 로드 오류:",e)}},[]);let eg=(e,t)=>{let a={...es};if(e.includes(".")){let[r,o]=e.split(".");a[r]&&"object"==typeof a[r]&&(a[r][o]=t)}else a[e]=t;ec(a),localStorage.setItem("tableSettings",JSON.stringify(a));let r=document.documentElement,o={popupWidth:"--popup-width",popupHeight:"--popup-height",popupTableFontSize:"--popup-table-font-size",popupBarcodeFontSize:"--popup-barcode-font-size",popupCellPadding:"--popup-cell-padding",popupLineHeight:"--popup-line-height",mainTableFontSize:"--main-table-font-size",mainBarcodeFontSize:"--main-barcode-font-size",mainCellPadding:"--main-cell-padding",mainLineHeight:"--main-line-height"}[e];if(o){let a="";e.includes("FontSize")||e.includes("Padding")?a="rem":e.includes("Width")&&"popupWidth"!==e?a="px":e.includes("Height")?a="vh":"popupWidth"===e&&(a="vw"),r.style.setProperty(o,"".concat(t).concat(a))}if(e.startsWith("autoTextSize.")||e.startsWith("barcodeFormat.")){let[t,o]=e.split(".");if(a[t]&&"object"==typeof a[t]){let e=a[t];void 0!==e[o]&&r.style.setProperty("--".concat(t,"-").concat("autoTextSize"===t?"enabled"===o?"enabled":"minFontSize"===o?"minFontSize":"maxFontSize"===o?"maxFontSize":"adjustForOverflow"===o?"adjustForOverflow":o:"enabled"===o?"enabled":"mainCodeSize"===o?"mainCodeSize":"subInfoSize"===o?"subInfoSize":"lineHeight"===o?"lineHeight":o),String(e[o]))}}es.autoTextSize.enabled&&setTimeout(ey,100)},ex=(e,t)=>{let a={...es};a.columnAlignment[e]=t,ec(a),localStorage.setItem("tableSettings",JSON.stringify(a)),document.documentElement.style.setProperty("--column-".concat(e,"-alignment"),t)},eb=(e,t)=>{let a={...es};a.columnWidths[e]=t,ec(a),localStorage.setItem("tableSettings",JSON.stringify(a)),document.documentElement.style.setProperty("--column-".concat(e,"-width"),"".concat(t,"px")),es.autoTextSize.enabled&&setTimeout(ey,100)},eN=(e,t)=>{let a={...es};a.autoTextSize[e]=t,ec(a),localStorage.setItem("tableSettings",JSON.stringify(a)),document.documentElement.style.setProperty("--auto-text-size-".concat("enabled"===e?"enabled":"minFontSize"===e?"minFontSize":"maxFontSize"===e?"maxFontSize":"adjustForOverflow"===e?"adjustForOverflow":e),t.toString()),("enabled"===e||"adjustForOverflow"===e)&&setTimeout(ey,100)},ef=(e,t)=>{let a={...es};a.barcodeFormat[e]=t,ec(a),localStorage.setItem("tableSettings",JSON.stringify(a)),document.documentElement.style.setProperty("--barcode-format-".concat("enabled"===e?"enabled":"mainCodeSize"===e?"mainCodeSize":"subInfoSize"===e?"subInfoSize":"lineHeight"===e?"lineHeight":e),t.toString()),"enabled"===e&&!0===t&&setTimeout(ey,100)},ey=(0,o.useCallback)(()=>{es.autoTextSize.enabled&&document.querySelectorAll(".pending-returns-table, .main-table").forEach(e=>{e.querySelectorAll("td").forEach(e=>{let t=e.textContent||"",a=e.offsetWidth;if(e.scrollWidth>a&&t.trim().length>0){if(e.classList.add("overflow-detected"),es.autoTextSize.adjustForOverflow){let r=16*es.autoTextSize.minFontSize,o=16*es.autoTextSize.maxFontSize,n=Math.max(r,1.2*(a/Math.max(t.length,1)));n=Math.min(o,n),e.style.fontSize="".concat(n,"px"),e.style.lineHeight="1.2",e.style.whiteSpace="normal",e.style.wordBreak="break-word",e.style.overflow="visible"}}else e.classList.remove("overflow-detected"),e.style.fontSize="",e.style.lineHeight="",e.style.whiteSpace="",e.style.wordBreak="",e.style.overflow=""})})},[es.autoTextSize]);(0,o.useEffect)(()=>{if(es.autoTextSize.enabled){let e=setTimeout(ey,50),t=setTimeout(ey,200);return()=>{clearTimeout(e),clearTimeout(t)}}},[e.pendingReturns,e.completedReturns,es.autoTextSize.enabled,ey]),(0,o.useCallback)(async(e,t)=>{try{S("".concat("products"===t?"상품":"반품"," 엑셀 파일 처리 시작:"),e.name);let a="products"===t?await c(e):await s(e);return S("".concat("products"===t?"상품":"반품"," 엑셀 파일 처리 완료:"),{파일명:e.name,데이터길이:a.length}),a}catch(e){throw Error("엑셀 파일 처리 오류: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}},[]),(0,o.useCallback)((e,t)=>{let a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a},[]);let ej=()=>{E?T([]):T(e.pendingReturns.map((e,t)=>t)),D(!E),F(null)},ev=e=>{z(e),k(e.detailReason||""),N(!0),eq(e=>e+10)},ew=(0,o.useCallback)(e=>{w&&(t({type:"UPDATE_RETURN_REASON",payload:{id:w.id,detailReason:e}}),N(!1),eq(e=>Math.max(0,e-10)),p("반품 사유 상세 정보가 저장되었습니다."))},[w,t]),eS=(e,t,a)=>t>0&&a[t-1].orderNumber===e.orderNumber?"bg-gray-50":"",eC=e=>!!e&&"string"==typeof e&&(e.includes("불량")||e.includes("하자")||e.includes("파손"));(0,o.useCallback)(e=>{X(e),V(!0),eq(e=>e+10)},[]);let ez=()=>{_?I([]):I(eZ.map((e,t)=>t)),M(!_),U(null)},eR=e=>{if(!e||"string"!=typeof e)return"";let t=e.toLowerCase();return t.includes("불실")||t.includes("변심")||t.includes("단순")?"단순변심":t.includes("실못")||t.includes("잘못")&&t.includes("주문")?"주문실수":t.includes("파손")||t.includes("불량")?"파손 및 불량":e},ek=(0,o.useCallback)(()=>{if(!e.products||0===e.products.length){p("삭제할 상품 데이터가 없습니다.");return}confirm("정말로 모든 상품 데이터를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&(t({type:"SET_PRODUCTS",payload:[]}),eu({...e,products:[]}),p("모든 상품 데이터가 삭제되었습니다."))},[e,t,eu]);(0,o.useCallback)(e=>{q(e),H(!0),eq(e=>e+10)},[]);let eP=(0,o.useCallback)(a=>{if(!W)return;let r={...W,returnTrackingNumber:a.trim()};if(a.trim()){t({type:"REMOVE_PENDING_RETURN",payload:{id:r.id}});let e={...r,status:"COMPLETED",completedAt:new Date};t({type:"ADD_COMPLETED_RETURN",payload:e}),p("".concat(e.productName," 상품이 입고완료 처리되었습니다."))}else t({type:"UPDATE_PENDING_RETURN",payload:r}),p("반품송장번호가 업데이트되었습니다.");eu(e),H(!1),q(null),eq(e=>Math.max(0,e-10))},[W,t,e,eu]),[eT,eE]=(0,o.useState)(""),[eD,eL]=(0,o.useState)([]),[eF,eO]=(0,o.useState)(!1),eI=()=>{if(!eT.trim()){eO(!1),eL([]);return}let t=eT.toLowerCase().trim(),a=e.completedReturns.filter(e=>e.customerName&&e.customerName.toLowerCase().includes(t)||e.orderNumber&&e.orderNumber.toLowerCase().includes(t));eL(a),eO(!0),0===a.length?p("검색 결과가 없습니다."):p("".concat(a.length,"개의 검색 결과를 찾았습니다."))},e_=e=>{let t={};return e.forEach(e=>{if(e.completedAt){let a=new Date(e.completedAt),r=new Date(a.getFullYear(),a.getMonth(),a.getDate()).toISOString().split("T")[0];t[r]||(t[r]=[]),t[r].push(e)}}),Object.entries(t).sort((e,t)=>{let[a]=e,[r]=t;return r.localeCompare(a)}).map(e=>{let[t,a]=e;return{date:t,items:a}})};(0,o.useMemo)(()=>Object.entries(e.completedReturns.reduce((e,t)=>{if(!t.completedAt)return e;let a=new Date(t.completedAt),r=new Date(a.getFullYear(),a.getMonth(),a.getDate()).toLocaleDateString();return e[r]||(e[r]=[]),e[r].push(t),e},{})).map(e=>{let[t,a]=e;return{date:t,items:a.sort((e,t)=>new Date(t.completedAt).getTime()-new Date(e.completedAt).getTime())}}).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),[e.completedReturns]);let eM=(0,o.useMemo)(()=>eF&&0!==eD.length?e_(eD):[],[eF,eD]),eA=e=>e.barcode&&"-"!==e.barcode?e.purchaseName&&"-"!==e.purchaseName?(0,r.jsx)("span",{children:e.purchaseName}):(0,r.jsx)("span",{children:e.productName}):(0,r.jsx)("button",{className:"text-blue-600 hover:text-blue-800 underline",onClick:()=>ta(e),children:e.productName});function eU(e,t){var a,r;let o={...e};if(e.barcode&&"-"!==e.barcode)return e;let n=t=>{if(!e.optionName||0===t.length)return t[0]||null;let a=e.optionName.toLowerCase().trim(),r=t.find(e=>e.optionName&&e.optionName.toLowerCase().trim()===a);if(r)return console.log("✅ 옵션명 정확 매칭: ".concat(e.optionName," → ").concat(r.optionName)),r;console.log('\uD83D\uDD0D 색상 기반 매칭 시도: "'.concat(e.optionName,'"'));let o=s(a);if(console.log('추출된 색상: "'.concat(o,'"')),o){let e=t.filter(e=>!!e.optionName&&s(e.optionName.toLowerCase().trim())===o);if(e.length>0)return console.log("✅ 색상 기반 매칭 성공: ".concat(o," → ").concat(e[0].optionName)),e[0]}console.log('\uD83D\uDD0D 콤마 기준 분리 매칭 시도: "'.concat(e.optionName,'"'));let n=a.split(",").map(e=>e.trim()).filter(e=>e.length>0);if(console.log("분리된 부분들: [".concat(n.join(", "),"]")),n.length>1){let a=null,r=0;for(let e of t){if(!e.optionName)continue;let t=e.optionName.toLowerCase().trim().split(",").map(e=>e.trim()).filter(e=>e.length>0),o=0;for(let e of n)for(let a of t)if(e===a||e.includes(a)||a.includes(e)){o++;break}if(o>0){let l=o/Math.max(n.length,t.length);console.log("  - ".concat(e.optionName,": ").concat(o,"/").concat(n.length," 부분 매칭, 점수: ").concat(l.toFixed(2))),l>r&&l>=.5&&(r=l,a=e)}}if(a)return console.log("✅ 콤마 기준 분리 매칭 성공: ".concat(e.optionName," → ").concat(a.optionName," (점수: ").concat(r.toFixed(2),")")),a}let c=null,i=.7;for(let e of t)if(e.optionName){let t=C(a,e.optionName.toLowerCase().trim());t>i&&(i=t,c=e)}if(c)return console.log("✅ 옵션명 유사도 매칭: ".concat(e.optionName," → ").concat(c.optionName," (유사도: ").concat(i.toFixed(2),")")),c;console.log('\uD83D\uDD0D 옵션명 부분 매칭 시도: "'.concat(e.optionName,'"'));let d=null,m=0,u=l(a);for(let e of(console.log("반품 옵션 키워드: [".concat(u.join(", "),"]")),t))if(e.optionName){let t=l(e.optionName.toLowerCase().trim()),a=u.filter(e=>t.some(t=>!!(t===e||e.length>=3&&t.includes(e)||t.length>=3&&e.includes(t))));if(a.length>0){let r=a.length/Math.max(u.length,t.length)*.8+a.length/u.length*.2;console.log("  - ".concat(e.optionName,": 공통키워드 ").concat(a.length,"개 [").concat(a.join(", "),"], 점수: ").concat(r.toFixed(2))),r>m&&r>=.4&&(m=r,d=e,console.log("    → 현재 최고 점수로 선택됨"))}else console.log("  - ".concat(e.optionName,": 공통키워드 없음"))}return d?(console.log("✅ 옵션명 부분 매칭 성공: ".concat(e.optionName," → ").concat(d.optionName," (점수: ").concat(m.toFixed(2),")")),d):(console.log("⚠️ 옵션명 매칭 실패, 매칭 불가: ".concat(e.optionName)),null)},l=e=>e.replace(/[\[\]]/g,"").split(/[,\/:\-\s]+/).map(e=>e.trim()).filter(e=>e.length>0&&"선택"!==e),s=e=>{for(let t of["블랙","화이트","네이비","그레이","베이지","레드","블루","그린","옐로우","퍼플","핑크","오렌지","브라운","카멜","민트","아이보리","소라","곤색","연두","다크그레이","연핑크","오트밀","연겨자","회색","검정","곤색","아쿠아블루","메란지","라이트민트","연핑크","베이지"])if(e.includes(t.toLowerCase()))return t.toLowerCase();return null},c=(null===(a=e.purchaseName)||void 0===a?void 0:a.toLowerCase())||"",i=(null===(r=e.optionName)||void 0===r?void 0:r.toLowerCase())||"";if(c.includes("연채원")&&c.includes("607")){if(console.log('\uD83D\uDD0D 연채원 607 특별 매칭 시도: "'.concat(e.purchaseName,'" - "').concat(e.optionName,'"')),i.includes("블랙")&&i.includes("1사이즈")){console.log("\uD83D\uDD0D 블랙,1사이즈 특별 강화 매칭 시도");let e=t.find(e=>"B-10231420001"===e.barcode||"B-10231420001"===e.customProductCode);if(e)return console.log("✅ 블랙,1사이즈 특별 바코드 매칭 성공: B-10231420001"),o.barcode=e.barcode,o.purchaseName=e.purchaseName||e.productName,o.zigzagProductCode=e.zigzagProductCode||"",o.matchType="연채원607_블랙1사이즈_특별매칭",o.matchSimilarity=1,o.matchedProductName=e.productName,o.matchedProductOption=e.optionName,o;let a=t.find(e=>e.optionName&&"블랙,1사이즈"===e.optionName.toLowerCase().trim()&&e.purchaseName&&e.purchaseName.toLowerCase().includes("연채원")&&e.purchaseName.toLowerCase().includes("607"));if(a)return console.log("✅ 블랙,1사이즈 정확 매칭 성공: ".concat(a.barcode)),o.barcode=a.barcode,o.purchaseName=a.purchaseName||a.productName,o.zigzagProductCode=a.zigzagProductCode||"",o.matchType="연채원607_블랙1사이즈_정확매칭",o.matchSimilarity=1,o.matchedProductName=a.productName,o.matchedProductOption=a.optionName,o}let a=t.filter(e=>e.optionName&&e.optionName.toLowerCase().trim()===i.trim());if(a.length>0)return console.log('✅ 연채원 607 정확한 옵션명 매칭: "'.concat(i,'" → "').concat(a[0].optionName,'"')),o.barcode=a[0].barcode,o.purchaseName=a[0].purchaseName||a[0].productName,o.zigzagProductCode=a[0].zigzagProductCode||"",o.matchType="연채원607_정확옵션매칭",o.matchSimilarity=1,o.matchedProductName=a[0].productName,o.matchedProductOption=a[0].optionName,o;let r=i.split(",").map(e=>e.trim()).filter(e=>e.length>0);if(console.log("분리된 옵션 부분: [".concat(r.join(", "),"]")),r.length>=2){let e=r.find(e=>["블랙","화이트","네이비","그레이","베이지","레드","블루","그린"].includes(e)),a=r.find(e=>e.includes("사이즈")||/^\d+$/.test(e)||/^[SMLX]+$/i.test(e));console.log('색상 부분: "'.concat(e,'", 사이즈 부분: "').concat(a,'"'));let n=t.filter(e=>e.purchaseName&&e.purchaseName.toLowerCase().includes("연채원")&&e.purchaseName.toLowerCase().includes("607"));if(console.log("연채원 607 사입상품명 상품들: ".concat(n.length,"개")),n.length>0){if("블랙"===e){let e=n.filter(e=>e.optionName&&e.optionName.toLowerCase().includes("블랙"));if(console.log("연채원 607 + 블랙 색상 상품들: ".concat(e.length,"개")),e.length>0){if(a){let t=e.filter(e=>e.optionName&&e.optionName.toLowerCase().includes(a.toLowerCase()));if(t.length>0)return console.log('✅ 연채원 607 + 블랙 + 사이즈 매칭: "'.concat(i,'" → "').concat(t[0].optionName,'"')),o.barcode=t[0].barcode,o.purchaseName=t[0].purchaseName||t[0].productName,o.zigzagProductCode=t[0].zigzagProductCode||"",o.matchType="연채원607_사입명색상사이즈매칭",o.matchSimilarity=.98,o.matchedProductName=t[0].productName,o.matchedProductOption=t[0].optionName,o}return console.log('✅ 연채원 607 + 블랙 색상 매칭: "'.concat(i,'" → "').concat(e[0].optionName,'"')),o.barcode=e[0].barcode,o.purchaseName=e[0].purchaseName||e[0].productName,o.zigzagProductCode=e[0].zigzagProductCode||"",o.matchType="연채원607_사입명색상매칭",o.matchSimilarity=.95,o.matchedProductName=e[0].productName,o.matchedProductOption=e[0].optionName,o}}let t=null,l=0;for(let e of n){if(!e.optionName)continue;let a=e.optionName.toLowerCase().trim().split(",").map(e=>e.trim()).filter(e=>e.length>0),o=0;for(let e of r)for(let t of a)if(e===t){o++;break}if(o>0){let n=o/Math.max(r.length,a.length);console.log("  - ".concat(e.optionName,": ").concat(o,"/").concat(r.length," 정확 매칭, 점수: ").concat(n.toFixed(2))),n>l&&(l=n,t=e)}}if(t&&l>=.5)return console.log('✅ 연채원 607 + 옵션 부분 매칭: "'.concat(i,'" → "').concat(t.optionName,'" (점수: ').concat(l.toFixed(2),")")),o.barcode=t.barcode,o.purchaseName=t.purchaseName||t.productName,o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="연채원607_사입명옵션매칭",o.matchSimilarity=l,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o}}if(i.includes("블랙")){let e=t.find(e=>"B-10231420001"===e.barcode||"B-10231420001"===e.customProductCode);if(e)return console.log("✅ 연채원 607 블랙 바코드 매칭: B-10231420001"),o.barcode=e.barcode,o.purchaseName=e.purchaseName||e.productName,o.zigzagProductCode=e.zigzagProductCode||"",o.matchType="연채원607_바코드매칭",o.matchSimilarity=.8,o.matchedProductName=e.productName,o.matchedProductOption=e.optionName,o}}if(o.barcode&&"-"!==o.barcode)return console.log("✅ 연채원 607 특별 매칭 완료: ".concat(o.barcode)),o;if(e.customProductCode&&"-"!==e.customProductCode){console.log('\uD83D\uDD0D 자체상품코드 "'.concat(e.customProductCode,'"로 매칭 시도...'));let a=t.filter(t=>t.customProductCode&&t.customProductCode.toLowerCase().trim()===e.customProductCode.toLowerCase().trim()||t.zigzagProductCode&&t.zigzagProductCode.toLowerCase().trim()===e.customProductCode.toLowerCase().trim());if(a.length>0){let t=n(a);if(t)return console.log("✅ 자체상품코드 정확 매칭 성공 (옵션 고려): ".concat(e.customProductCode," → ").concat(t.purchaseName||t.productName," [").concat(t.optionName,"]")),o.barcode=t.barcode,o.purchaseName=t.purchaseName||t.productName,o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="custom_code_exact",o.matchSimilarity=1,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o;console.log("❌ 자체상품코드 매칭 실패: 옵션명 매칭 불가 (".concat(e.optionName,")"))}console.log('\uD83D\uDD0D 자체상품코드 "'.concat(e.customProductCode,'"와 사입상품명 유사도 매칭 시도...'));let r=null,l=e.customProductCode.toLowerCase().trim();for(let e of t)if(e.purchaseName&&"string"==typeof e.purchaseName){let t=e.purchaseName.toLowerCase().trim();if(t.includes(l)||l.includes(t))(!r||.95>r.similarity)&&(r={product:e,similarity:.95,matchType:"자체상품코드-사입명 포함관계"},console.log("\uD83D\uDCCC 포함관계 발견 (유사도: ".concat("0.95",'): "').concat(l,'" ↔ "').concat(t,'"')));else{let a=C(l,t);a>.4&&(!r||a>r.similarity)&&(r={product:e,similarity:a,matchType:"자체상품코드-사입명 유사도"},console.log("\uD83D\uDCCA 유사도 매칭 (유사도: ".concat(a.toFixed(2),'): "').concat(l,'" ↔ "').concat(t,'"')))}}if(r&&r.similarity>.5)return console.log("✅ 자체상품코드 기반 매칭 성공 (".concat(r.matchType,", 유사도: ").concat(r.similarity.toFixed(2),")")),o.barcode=r.product.barcode,o.purchaseName=r.product.purchaseName||r.product.productName,o.zigzagProductCode=r.product.zigzagProductCode||e.zigzagProductCode,o.customProductCode=r.product.customProductCode||r.product.zigzagProductCode||"",o.matchType=r.matchType,o.matchSimilarity=r.similarity,o.matchedProductName=r.product.productName,o.matchedProductOption=r.product.optionName,o;console.log("❌ 자체상품코드 기반 매칭 실패: ".concat(e.customProductCode))}if(e.purchaseName&&"-"!==e.purchaseName){let a=t.filter(t=>{var a;return t.purchaseName&&t.purchaseName.toLowerCase().trim()===(null===(a=e.purchaseName)||void 0===a?void 0:a.toLowerCase().trim())});if(a.length>0){let t=n(a);if(t)return console.log("✅ 사입상품명 매칭 성공 (옵션 고려): ".concat(e.purchaseName," → ").concat(t.productName," [").concat(t.optionName,"]")),o.barcode=t.barcode,o.customProductCode=t.customProductCode||t.zigzagProductCode||"",o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="purchase_name_match",o.matchSimilarity=1,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o;console.log("❌ 사입상품명 매칭 실패: 옵션명 매칭 불가 (".concat(e.optionName,")"))}}if(e.zigzagProductCode&&"-"!==e.zigzagProductCode){console.log('\uD83D\uDD0D 지그재그 상품코드 "'.concat(e.zigzagProductCode,'"로 매칭 시도...'));let a=t.filter(t=>t.zigzagProductCode&&t.zigzagProductCode.toLowerCase().trim()===e.zigzagProductCode.toLowerCase().trim());if(a.length>0){let t=n(a);if(t)return console.log("✅ 지그재그 상품코드 정확 매칭 성공 (옵션 고려): ".concat(e.zigzagProductCode," → ").concat(t.productName," [").concat(t.optionName,"]")),o.barcode=t.barcode,o.purchaseName=t.purchaseName||t.productName,o.customProductCode=t.customProductCode||"",o.matchType="zigzag_code_exact",o.matchSimilarity=1,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o}console.log('\uD83D\uDD0D 지그재그 코드 "'.concat(e.zigzagProductCode,'"와 사입상품명 유사도 매칭 시도...'));let r=null,l=e.zigzagProductCode.toLowerCase().trim();for(let e of t)if(e.purchaseName&&"string"==typeof e.purchaseName){let t=e.purchaseName.toLowerCase().trim();if(t.includes(l)||l.includes(t))(!r||.9>r.similarity)&&(r={product:e,similarity:.9,matchType:"지그재그코드-사입명 포함관계"},console.log("\uD83D\uDCCC 포함관계 발견 (유사도: ".concat("0.90",'): "').concat(l,'" ↔ "').concat(t,'"')));else{let a=C(l,t);a>.4&&(!r||a>r.similarity)&&(r={product:e,similarity:a,matchType:"지그재그코드-사입명 유사도"},console.log("\uD83D\uDCCA 유사도 매칭 (유사도: ".concat(a.toFixed(2),'): "').concat(l,'" ↔ "').concat(t,'"')))}}if(r&&r.similarity>.5)return console.log("✅ 지그재그 코드 기반 매칭 성공 (".concat(r.matchType,", 유사도: ").concat(r.similarity.toFixed(2),")")),o.barcode=r.product.barcode,o.purchaseName=r.product.purchaseName||r.product.productName,o.customProductCode=r.product.customProductCode||r.product.zigzagProductCode||"",o.matchType=r.matchType,o.matchSimilarity=r.similarity,o.matchedProductName=r.product.productName,o.matchedProductOption=r.product.optionName,o;console.log("❌ 지그재그 코드 기반 매칭 실패: ".concat(e.zigzagProductCode))}if(e.productName){let a=t.filter(t=>{var a,r;return t.productName&&t.productName.toLowerCase().trim()===(null===(a=e.productName)||void 0===a?void 0:a.toLowerCase().trim())||t.purchaseName&&t.purchaseName.toLowerCase().trim()===(null===(r=e.productName)||void 0===r?void 0:r.toLowerCase().trim())});if(a.length>0){let t=n(a);if(t)return console.log("✅ 상품명 정확 매칭 성공 (옵션 고려): ".concat(e.productName," → ").concat(t.productName," [").concat(t.optionName,"]")),o.barcode=t.barcode,o.customProductCode=t.customProductCode||t.zigzagProductCode||"",o.purchaseName=t.purchaseName||t.productName,o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="name_exact",o.matchSimilarity=1,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o;console.log("❌ 상품명 정확 매칭 실패: 옵션명 매칭 불가 (".concat(e.optionName,")"))}let r=t.filter(t=>t.productName&&e.productName&&(t.productName.toLowerCase().includes(e.productName.toLowerCase())||e.productName.toLowerCase().includes(t.productName.toLowerCase()))||t.purchaseName&&e.productName&&(t.purchaseName.toLowerCase().includes(e.productName.toLowerCase())||e.productName.toLowerCase().includes(t.purchaseName.toLowerCase())));if(r.length>0){let t=n(r);if(t)return console.log("✅ 상품명 부분 매칭 성공 (옵션 고려): ".concat(e.productName," → ").concat(t.productName," [").concat(t.optionName,"]")),o.barcode=t.barcode,o.customProductCode=t.customProductCode||t.zigzagProductCode||"",o.purchaseName=t.purchaseName||t.productName,o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="name_partial",o.matchSimilarity=.8,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o;console.log("❌ 상품명 부분 매칭 실패: 옵션명 매칭 불가 (".concat(e.optionName,")"))}let l=[];for(let a of t){if(a.productName&&e.productName){let t=C(a.productName.toLowerCase(),e.productName.toLowerCase());t>.6&&l.push({product:a,similarity:t})}if(a.purchaseName&&e.productName){let t=C(a.purchaseName.toLowerCase(),e.productName.toLowerCase());t>.6&&l.push({product:a,similarity:t})}}if(l.length>0){l.sort((e,t)=>t.similarity-e.similarity);let t=n(l.filter(e=>e.similarity>=l[0].similarity-.1).map(e=>e.product));if(t){let a=l.find(e=>e.product===t);return console.log("✅ 상품명 유사도 매칭 성공 (옵션 고려): ".concat(e.productName," → ").concat(t.productName," [").concat(t.optionName,"] (유사도: ").concat(null==a?void 0:a.similarity.toFixed(2),")")),o.barcode=t.barcode,o.customProductCode=t.customProductCode||t.zigzagProductCode||"",o.purchaseName=t.purchaseName||t.productName,o.zigzagProductCode=t.zigzagProductCode||"",o.matchType="name_similarity",o.matchSimilarity=(null==a?void 0:a.similarity)||.6,o.matchedProductName=t.productName,o.matchedProductOption=t.optionName,o}console.log("❌ 상품명 유사도 매칭 실패: 옵션명 매칭 불가 (".concat(e.optionName,")"))}}return console.log("❌ 매칭 실패: ".concat(e.productName)),o.matchType="no_match",o.matchSimilarity=0,o}let eB=e=>e.map(e=>({trackingNumber:e.pickupTrackingNumber||e.returnTrackingNumber||"no-tracking",items:[e],totalQuantity:e.quantity||1,isGroup:!1})),eH=t=>{let{items:a}=t,o=eB(a);return(0,r.jsxs)("table",{className:"min-w-full border-collapse main-table ".concat(es.autoTextSize.enabled?"auto-text-size-enabled":""),children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50",children:[(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 text-center col-actions",children:(0,r.jsx)("input",{type:"checkbox",checked:_,onChange:ez,className:"w-5 h-5"})}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 w-24 col-customer-name",children:"고객명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-order-number",children:"주문번호"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:"사입상품명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-option-name",children:"옵션명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 w-12 col-quantity",children:"수량"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-return-reason",children:"반품사유"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-tracking-number",children:"수거송장번호"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-barcode",children:"바코드번호"})]})}),(0,r.jsx)("tbody",{children:o.map((t,o)=>{let n=t.items[0],s=a.findIndex(e=>e.id===n.id),c=O.includes(s);return(0,r.jsxs)("tr",{className:"hover:bg-blue-50 ".concat(eC(n.returnReason)?"text-red-500":""),children:[(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-actions",children:(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)("input",{type:"checkbox",checked:c,onChange:e=>{e.target.checked?I(e=>[...e,s]):I(e=>e.filter(e=>e!==s))},className:"w-5 h-5"})})}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 whitespace-nowrap overflow-hidden text-ellipsis max-w-[120px] col-customer-name",children:n.customerName}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 whitespace-nowrap overflow-hidden text-ellipsis col-order-number",children:n.orderNumber}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:(0,r.jsx)("div",{className:n.barcode?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words line-clamp-2",children:eA(n)})}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 whitespace-nowrap overflow-hidden text-ellipsis col-option-name",children:l(n.optionName)}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 whitespace-nowrap text-center col-quantity",children:n.quantity}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 whitespace-nowrap overflow-hidden text-ellipsis max-w-[150px] cursor-pointer col-return-reason",onClick:()=>eC(n.returnReason)&&ev(n),children:e2(n)}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-tracking-number",children:(0,r.jsx)("div",{className:"font-mono text-sm whitespace-nowrap bg-blue-100 px-2 py-1 rounded text-center",children:"no-tracking"===t.trackingNumber?"-":t.trackingNumber})}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-barcode",children:es.barcodeFormat.enabled&&n.barcode&&"-"!==n.barcode?(0,r.jsxs)("div",{className:"barcode-field ".concat(es.barcodeFormat.enabled?"enabled":""),children:[(0,r.jsx)("div",{className:"main-code",children:n.barcode}),(()=>{let t=e.products.find(e=>e.barcode===n.barcode);return t?(0,r.jsxs)("div",{className:"sub-info",children:["(",t.purchaseName," ",t.optionName,")"]}):null})()]}):(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("div",{className:"font-mono font-semibold",children:n.barcode||"-"}),n.barcode&&"-"!==n.barcode&&(()=>{let t=e.products.find(e=>e.barcode===n.barcode);return t?(0,r.jsxs)("div",{className:"main-barcode-info",title:"".concat(t.purchaseName," ").concat(t.optionName),children:["(",t.purchaseName," ",t.optionName,")"]}):null})()]})})]},n.id)})})]})},[eW,eq]=(0,o.useState)(0),[eJ,eK]=(0,o.useState)([]),[eG,eV]=(0,o.useState)(0),[eY,eX]=(0,o.useState)(""),[e$,eQ]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=document.createElement("style");return e.innerHTML="\n      dialog {\n        position: fixed !important;\n        margin: auto !important;\n        border: none !important;\n        border-radius: 0.5rem !important;\n        padding: 1rem !important;\n        background: white !important;\n        max-width: 95vw !important;\n        max-height: 90vh !important;\n        overflow: auto !important;\n      }\n      dialog::backdrop {\n        background-color: rgba(0, 0, 0, 0.4) !important;\n      }\n      .popup-layer {\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2) !important;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,o.useEffect)(()=>{if(e.completedReturns.length>0){let t=[...new Set(e.completedReturns.map(e=>new Date(e.completedAt).toLocaleDateString()))].sort((e,t)=>new Date(t).getTime()-new Date(e).getTime());eQ(t),eX(t[0]||""),eV(0)}},[e.completedReturns]);let eZ=(0,o.useMemo)(()=>!eY||eF?[]:e.completedReturns.filter(e=>new Date(e.completedAt).toLocaleDateString()===eY),[e.completedReturns,eY,eF]),e0=e=>{let t;0!==e$.length&&(eV(t="prev"===e&&eG<e$.length-1?eG+1:"next"===e&&eG>0?eG-1:"prev"===e?0:e$.length-1),eX(e$[t]),p("".concat(new Date(e$[t]).toLocaleDateString("ko-KR")," 날짜의 데이터로 이동했습니다.")))},e1=e=>{e0(e)},e2=e=>{let t=e.returnReason;return e.detailReason&&""!==e.detailReason.trim()&&!t.toLowerCase().includes(e.detailReason.toLowerCase())&&(t+=" (".concat(e.detailReason,")")),t},[e4,e3]=(0,o.useState)(""),[e5,e6]=(0,o.useState)(null),[e7,e8]=(0,o.useState)(null),e9=()=>{let a=e4.trim();if(!a){p("수거송장번호를 입력해주세요.");return}let r=e.pendingReturns.filter(e=>e.pickupTrackingNumber&&e.pickupTrackingNumber===a||e.returnTrackingNumber&&e.returnTrackingNumber===a);if(0===r.length){p("'".concat(a,"' 수거송장번호로 등록된 반품이 없습니다.")),e8(!1),e3("");return}e8(!0),d(!0);let o=new Date,n=new Date(o.getFullYear(),o.getMonth(),o.getDate());n.setHours(0,0,0,0);let l=r.map(e=>({...e,status:"COMPLETED",completedAt:n})),s=[...l,...e.completedReturns],c=e.pendingReturns.filter(e=>!(e.pickupTrackingNumber&&e.pickupTrackingNumber===a||e.returnTrackingNumber&&e.returnTrackingNumber===a));t({type:"SET_RETURNS",payload:{...e,pendingReturns:c,completedReturns:s}}),localStorage.setItem("pendingReturns",JSON.stringify(c)),localStorage.setItem("completedReturns",JSON.stringify(s)),localStorage.setItem("lastUpdated",new Date().toISOString());let i=n.toLocaleDateString();if(i!==eY){eX(i);let e=e$.indexOf(i);e>=0?eV(e):(eQ([i,...e$]),eV(0))}p("'".concat(a,"' 수거송장번호로 ").concat(l.length,"개 항목이 입고 처리되었습니다.")),e3(""),d(!1)},[te,tt]=(0,o.useState)(null),ta=e=>{X(e),tt(e),V(!0),eq(e=>e+10)},tr=()=>{if(0===O.length)return;d(!0);let a=O.map(e=>eZ[e]),r=a.map(e=>{let{completedAt:t,status:a,...r}=e;return{...r,status:"PENDING"}}),o=e.completedReturns.filter(e=>!a.some(t=>t.orderNumber===e.orderNumber&&t.productName===e.productName&&t.optionName===e.optionName&&t.returnTrackingNumber===e.returnTrackingNumber)),n=[...e.pendingReturns,...r];t({type:"SET_RETURNS",payload:{...e,pendingReturns:n,completedReturns:o}}),localStorage.setItem("pendingReturns",JSON.stringify(n)),localStorage.setItem("completedReturns",JSON.stringify(o)),localStorage.setItem("lastUpdated",new Date().toISOString()),p("".concat(O.length,"개의 항목이 입고전 목록으로 되돌아갔습니다.")),I([]),M(!1),d(!1)},to=()=>{if(0===O.length){p("재매칭할 항목을 선택해주세요.");return}X(O.map(e=>eZ[e])[0]),V(!0),O.length>1&&p("".concat(O.length,"개 항목이 선택되었습니다. 첫 번째 항목부터 재매칭을 진행합니다."))},tn=()=>{if(0===O.length){p("날짜를 변경할 항목을 선택해주세요.");return}eo(new Date().toISOString().split("T")[0]),ea(!0)},tl=a=>{if(0===O.length)return;d(!0);let r=O.map(e=>eZ[e]),o=r.map(e=>({...e,completedAt:new Date(a)})),n=[...e.completedReturns.filter(e=>!r.some(t=>t.orderNumber===e.orderNumber&&t.productName===e.productName&&t.optionName===e.optionName&&t.returnTrackingNumber===e.returnTrackingNumber)),...o];t({type:"SET_RETURNS",payload:{...e,completedReturns:n}}),localStorage.setItem("completedReturns",JSON.stringify(n)),localStorage.setItem("lastUpdated",new Date().toISOString()),p("".concat(O.length,"개 항목의 날짜가 ").concat(new Date(a).toLocaleDateString("ko-KR"),"로 변경되었습니다.")),I([]),M(!1),ea(!1),d(!1)};return(0,r.jsxs)("main",{className:"min-h-screen p-4 md:p-6",children:[u&&(0,r.jsx)("div",{className:"mb-4 p-3 rounded ".concat(!1===e7?"bg-pink-100 text-red-800":!0===e7?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:u}),(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 mb-6",children:[(0,r.jsx)("button",{className:"px-4 py-2 text-white rounded ".concat(J.testButton),onClick:()=>{try{d(!0),p("로컬 저장소 상태를 확인 중...");let e=localStorage.getItem("pendingReturns"),t=localStorage.getItem("completedReturns"),a=localStorage.getItem("products"),r=localStorage.getItem("lastUpdated"),o=e?JSON.parse(e).length:0,n=t?JSON.parse(t).length:0,l=a?JSON.parse(a).length:0,s=0;for(let e in localStorage)localStorage.hasOwnProperty(e)&&(s+=localStorage[e].length);let c=(s/1048576).toFixed(2),i="\n        로컬 저장소 상태:\n        • 입고전 반품: ".concat(o,"개\n        • 입고완료 반품: ").concat(n,"개  \n        • 상품 데이터: ").concat(l,"개\n        • 저장소 사용량: ").concat(c,"MB\n        • 마지막 업데이트: ").concat(r?new Date(r).toLocaleString():"없음","\n      ");p(i),console.log("로컬 저장소 상태:",{pendingReturns:o,completedReturns:n,products:l,totalSizeMB:c,lastUpdated:r})}catch(e){p("로컬 저장소 확인 실패: ".concat(e instanceof Error?e.message:"알 수 없는 오류")),console.error("로컬 저장소 확인 실패:",e)}finally{d(!1)}},disabled:a,children:"저장소 상태 확인"}),(0,r.jsx)("button",{className:"px-4 py-2 text-white rounded ".concat(J.firebaseButton),onClick:()=>{d(!0),p("데이터를 백업 중입니다...");try{let t={pendingReturns:e.pendingReturns,completedReturns:e.completedReturns,products:e.products,exportDate:new Date().toISOString(),version:"1.0"},a=JSON.stringify(t,null,2),r=new Blob([a],{type:"application/json"}),o=URL.createObjectURL(r),n=document.createElement("a");n.href=o,n.download="반품데이터_백업_".concat(new Date().toISOString().split("T")[0],".json"),n.click(),URL.revokeObjectURL(o),p("데이터 백업이 완료되었습니다. 다운로드 폴더를 확인하세요.")}catch(e){console.error("백업 오류:",e),p("데이터 백업 중 오류가 발생했습니다.")}finally{d(!1)}},disabled:a,children:"데이터 백업"}),(0,r.jsxs)("label",{className:"px-4 py-2 text-white rounded text-center cursor-pointer bg-purple-500 hover:bg-purple-600",htmlFor:"restoreFile",children:["데이터 복원",(0,r.jsx)("input",{type:"file",id:"restoreFile",accept:".json",onChange:e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!r)return;d(!0),p("백업 데이터를 복원 중입니다...");let o=new FileReader;o.onload=a=>{try{var r;let e=JSON.parse(null===(r=a.target)||void 0===r?void 0:r.result);if(!e.version||!e.exportDate)throw Error("유효하지 않은 백업 파일입니다.");let o={pendingReturns:e.pendingReturns||[],completedReturns:e.completedReturns||[],products:e.products||[]};t({type:"SET_RETURNS",payload:o}),eu(o);let n=new Date(e.exportDate).toLocaleString();p("데이터 복원이 완료되었습니다. (백업 날짜: ".concat(n,")")),console.log("데이터 복원 완료:",{pendingReturns:o.pendingReturns.length,completedReturns:o.completedReturns.length,products:o.products.length,backupDate:n})}catch(e){console.error("복원 오류:",e),p("데이터 복원 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}finally{d(!1),e.target.value=""}},o.onerror=()=>{p("파일을 읽는 중 오류가 발생했습니다."),d(!1),e.target.value=""},o.readAsText(r)},className:"hidden",disabled:a})]}),(0,r.jsxs)("label",{className:"px-4 py-2 text-white rounded text-center cursor-pointer ".concat(J.productButton),htmlFor:"productFile",children:["상품 업로드",(0,r.jsx)("input",{type:"file",id:"productFile",accept:".xlsx,.xls",onChange:a=>{if(!a.target.files||0===a.target.files.length)return;let r=a.target.files[0];d(!0),p("상품 데이터 파일을 처리 중입니다..."),c(r).then(a=>{if(0===a.length){p("파일에서 유효한 상품 데이터를 찾을 수 없습니다.");return}t({type:"ADD_PRODUCTS",payload:a});let r=[...e.products,...a];localStorage.setItem("products",JSON.stringify(r)),localStorage.setItem("lastUpdated",new Date().toISOString());let o=e.pendingReturns.filter(e=>!e.barcode);if(o.length>0){let e=0;o.forEach(r=>{let o=eU(r,a);o.barcode&&(e++,t({type:"UPDATE_RETURN_ITEM",payload:o}))}),e>0?p("".concat(a.length,"개 상품이 추가되었습니다. ").concat(e,"개 반품 항목이 자동 매칭되었습니다.")):p("".concat(a.length,"개 상품이 추가되었습니다."))}else p("".concat(a.length,"개 상품이 추가되었습니다."))}).catch(e=>{console.error("상품 데이터 처리 오류:",e),p("상품 데이터 처리 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:String(e)))}).finally(()=>{d(!1),a.target.value=""})},ref:g,className:"hidden",disabled:a})]}),(0,r.jsxs)("label",{className:"px-4 py-2 text-white rounded text-center cursor-pointer ".concat(J.returnButton),htmlFor:"returnFile",children:["반품 업로드",(0,r.jsx)("input",{type:"file",id:"returnFile",accept:".xlsx,.xls",onChange:a=>{if(!a.target.files||0===a.target.files.length)return;let r=a.target.files[0];d(!0),p("반품 데이터 파일을 처리 중입니다..."),s(r).then(a=>{if(0===a.length){p("파일에서 유효한 반품 데이터를 찾을 수 없습니다.");return}let r=a.map(e=>({...e,returnReason:eR(e.returnReason)}));t({type:"ADD_RETURNS",payload:r});let o=[...e.pendingReturns,...r];localStorage.setItem("pendingReturns",JSON.stringify(o)),localStorage.setItem("lastUpdated",new Date().toISOString()),p("".concat(r.length,"개 반품 항목이 성공적으로 추가되었습니다."))}).catch(e=>{console.error("반품 데이터 처리 오류:",e),p("반품 데이터 처리 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:String(e)))}).finally(()=>{d(!1),a.target.value=""})},ref:h,className:"hidden",disabled:a})]}),(0,r.jsx)("button",{className:"px-4 py-2 text-white rounded ".concat(J.productListButton),onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.showModal()},disabled:a,children:"상품 목록"}),(0,r.jsxs)("button",{className:"px-4 py-2 text-white rounded ".concat(J.pendingButton),onClick:()=>Q(!0),disabled:a,children:["입고전 (",e.pendingReturns.length,")"]}),(0,r.jsx)("button",{className:"px-4 py-2 text-white rounded bg-orange-500 hover:bg-orange-600",onClick:()=>el(!0),disabled:a,children:"표 크기 조정"})]}),a&&(0,r.jsxs)("div",{className:"flex justify-center items-center my-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-2",children:"처리 중..."})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 border rounded-lg shadow-sm bg-white",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"수거송장번호로 입고"}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"수거송장번호 입력 후 Enter 또는 입고 버튼 클릭",className:"flex-1 px-4 py-2 border border-gray-300 rounded",value:e4,onChange:e=>e3(e.target.value),onKeyDown:e=>{if("Enter"===e.key){if(!e4.trim()){p("수거송장번호를 입력해주세요.");return}e9()}}}),(0,r.jsx)("button",{className:"px-4 py-2 text-white rounded ".concat(J.trackingButton),onClick:e9,disabled:a||!e4.trim(),children:"입고"})]})]}),(0,r.jsxs)("div",{className:"p-4 border rounded-lg shadow-sm bg-white",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"입고완료 반품 목록"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"px-3 py-1 text-white rounded ".concat(J.downloadButton),onClick:()=>{let t=[];if(eF&&eD.length>0?t=eD:eY&&eZ.length>0?t=eZ:e.completedReturns.length>0&&(t=e.completedReturns),0===t.length){p("다운로드할 입고 완료 데이터가 없습니다.");return}try{let e=t.filter(e=>e.barcode&&"-"!==e.barcode);if(0===e.length){p("바코드가 있는 항목이 없어서 CSV 파일을 생성할 수 없습니다.");return}let a=e.map(e=>({바코드번호:e.barcode||"",입고수량:e.quantity||1})),r=["바코드번호,입고수량",...a.map(e=>[e.바코드번호,e.입고수량].join(","))].join("\r\n"),o=new Blob(["\uFEFF"+r],{type:"text/csv"}),n=document.createElement("a"),l=URL.createObjectURL(o);n.setAttribute("href",l),n.setAttribute("download","입고잡기용_".concat(new Date().toISOString().split("T")[0],".csv")),n.setAttribute("type","text/csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l);let s="";eF?s="검색 결과 ":eY&&(s="".concat(new Date(eY).toLocaleDateString("ko-KR")," 날짜의 ")),p("".concat(s).concat(e.length,"개 항목이 입고잡기용 CSV 파일로 저장되었습니다. (바코드 미매칭 ").concat(t.length-e.length,"개 제외)"))}catch(e){console.error("CSV 생성 중 오류:",e),p("CSV 파일 생성 중 오류가 발생했습니다.")}},disabled:a||0===e.completedReturns.length,children:"목록 다운로드"}),(0,r.jsx)("button",{className:"px-3 py-1 text-white rounded bg-purple-500 hover:bg-purple-600",onClick:()=>{let t=[];if(eF&&eD.length>0?t=eD:eY&&eZ.length>0?t=eZ:e.completedReturns.length>0&&(t=e.completedReturns),0===t.length){p("다운로드할 입고 완료 데이터가 없습니다.");return}try{!function(e){let t=new Map;e.forEach(e=>{let a=e.pickupTrackingNumber||"no-tracking";t.has(a)||t.set(a,[]),t.get(a).push(e)});let a=[];t.forEach((e,t)=>{if(0===e.length)return;let r=e[0],o=r.customerName,n=r.returnReason,l=r.completedAt?new Date(r.completedAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\./g,"/"):"",s=new Map;e.forEach(e=>{let t=e.purchaseName||e.productName||"",a=e.optionName||"",r=a?"".concat(t,"-").concat(a):t;s.has(r)?s.get(r).quantity+=e.quantity:s.set(r,{quantity:e.quantity,purchaseName:t,optionName:a})});let c=e.reduce((e,t)=>e+t.quantity,0);Array.from(s.entries()).forEach((e,t)=>{let[r,s]=e;a.push([l,0===t?o:"",0===t?n:"",r,0===t?"".concat(c,"개"):""])})});let r=[["날짜","고객명","반품사유","사입상품명","총 수량"],...a],o=n.P6.book_new(),l=n.P6.aoa_to_sheet(r);l["!cols"]=[{wch:12},{wch:10},{wch:15},{wch:30},{wch:10}];let s=[];for(let e=0;e<r.length;e++)s.push({hpt:20});l["!rows"]=s;let c=[],i=1;t.forEach((e,t)=>{if(0===e.length)return;let a=new Map;e.forEach(e=>{let t=e.purchaseName||e.productName||"",r=e.optionName||"",o=r?"".concat(t,"-").concat(r):t;a.has(o)?a.get(o).quantity+=e.quantity:a.set(o,{quantity:e.quantity,purchaseName:t,optionName:r})});let r=Array.from(a.entries()).length;r>1&&(c.push({s:{r:i,c:1},e:{r:i+r-1,c:1}}),c.push({s:{r:i,c:2},e:{r:i+r-1,c:2}}),c.push({s:{r:i,c:4},e:{r:i+r-1,c:4}})),i+=r}),l["!merges"]=c;for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++){let a=n.P6.encode_cell({r:e,c:t});l[a]&&(l[a].s={font:{name:"맑은 고딕",sz:10,bold:!1},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},fill:{fgColor:{rgb:"FFFFFF"}}})}for(let e=0;e<r[0].length;e++){let t=n.P6.encode_cell({r:0,c:e});l[t]&&(l[t].s={font:{name:"맑은 고딕",sz:10,bold:!0},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},fill:{fgColor:{rgb:"F0F0F0"}}})}n.P6.book_append_sheet(o,l,"입고완료 반품목록");let d="입고완료_반품목록_".concat(new Date().toISOString().split("T")[0],".xlsx");n.NC(o,d)}(t);let e="";eF?e="검색 결과 ":eY&&(e="".concat(new Date(eY).toLocaleDateString("ko-KR")," 날짜의 ")),p("".concat(e).concat(t.length,"개 항목이 엑셀 파일로 저장되었습니다."))}catch(e){console.error("엑셀 생성 중 오류:",e),p("엑셀 파일 생성 중 오류가 발생했습니다.")}},disabled:a||0===e.completedReturns.length,children:"셀 복사용 다운로드"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row mb-4 space-y-2 md:space-y-0 md:space-x-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"고객명 또는 주문번호로 검색",className:"flex-1 px-4 py-2 border border-gray-300 rounded",value:eT,onChange:e=>eE(e.target.value),onKeyPress:e=>"Enter"===e.key&&eI()}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:eI,children:"검색"}),eF&&(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded",onClick:()=>{eE(""),eL([]),eO(!1)},children:"검색 취소"})]}),!eF&&e$.length>0&&(0,r.jsxs)("div",{className:"flex items-center justify-center mb-4 p-2 bg-gray-100 rounded-md",children:[(0,r.jsx)("button",{className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded-l-md",onClick:()=>e1("prev"),children:"<"}),(0,r.jsx)("div",{className:"mx-3 font-medium",children:eY&&new Date(eY).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}),(0,r.jsx)("button",{className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded-r-md",onClick:()=>e1("next"),children:">"})]}),e.completedReturns.length>0?(0,r.jsxs)("div",{className:"space-y-6",children:[eF&&eM.length>0&&eM.map(e=>{let{date:t,items:a}=e;return(0,r.jsxs)("div",{id:"date-group-".concat(t),className:"border border-gray-200 rounded-md overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-100 px-4 py-2 font-medium flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[new Date(t).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),(0,r.jsxs)("span",{className:"ml-2 text-gray-600 text-sm",children:["(",a.length,"개)"]})]}),O.length>0&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{className:"px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded",onClick:tr,children:["되돌리기 (",O.length,")"]}),(0,r.jsxs)("button",{className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:to,children:["재매칭 (",O.length,")"]}),(0,r.jsxs)("button",{className:"px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded",onClick:tn,children:["날짜변경 (",O.length,")"]})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)(eH,{items:a})})]},t)}),!eF&&eY&&(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-100 px-4 py-2 font-medium flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[new Date(eY).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),(0,r.jsxs)("span",{className:"ml-2 text-gray-600 text-sm",children:["(",eZ.length,"개)"]})]}),O.length>0&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{className:"px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded",onClick:tr,children:["되돌리기 (",O.length,")"]}),(0,r.jsxs)("button",{className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:to,children:["재매칭 (",O.length,")"]}),(0,r.jsxs)("button",{className:"px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded",onClick:tn,children:["날짜변경 (",O.length,")"]})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)(eH,{items:eZ})})]})]}):(0,r.jsx)("p",{children:"입고완료된 반품이 없습니다."})]}),B&&W&&(0,r.jsx)(f,{isOpen:B,onClose:()=>{e3(""),e6(null),p("수거송장번호 입력이 취소되었습니다.")},returnItem:W,onSave:eP,zIndex:1e3+eW}),(0,r.jsx)(j,{isOpen:$,onClose:()=>{Q(!1),T([])},items:e.pendingReturns,selectedItems:P,onRefresh:()=>{if(d(!0),p("데이터를 새로고침 중입니다..."),e.pendingReturns.length>0){let a=new Set(e.completedReturns.map(e=>"".concat(e.customerName,"_").concat(e.orderNumber,"_").concat(e.purchaseName||e.productName,"_").concat(e.optionName,"_").concat(e.returnTrackingNumber))),r=new Map;e.pendingReturns.forEach(e=>{let t="".concat(e.customerName,"_").concat(e.orderNumber,"_").concat(e.purchaseName||e.productName,"_").concat(e.optionName,"_").concat(e.returnTrackingNumber);if(a.has(t)){console.log("중복 항목 제외 (이미 입고완료): ".concat(t));return}r.has(t)||r.set(t,e)});let o=Array.from(r.values()),n=e.pendingReturns.length-o.length;n>0&&(console.log("중복 제거: ".concat(n,"개 항목 제거됨")),t({type:"SET_RETURNS",payload:{...e,pendingReturns:o}}))}if(e.pendingReturns.length>0&&e.products.length>0){let a=e.pendingReturns.map(t=>eU(t,e.products)),r=a.filter(e=>e.barcode).length-e.pendingReturns.filter(e=>e.barcode).length;r>0?(t({type:"SET_RETURNS",payload:{...e,pendingReturns:a}}),p("새로고침 완료: ".concat(r,"개 상품이 자동 매칭되었습니다."))):p("새로고침 완료. 매칭할 상품이 없습니다.")}else p("새로고침 완료.");setTimeout(()=>{d(!1)},500)},onProcessSelected:()=>{if(0===P.length)return;let a=P.map(t=>e.pendingReturns[t]);e.products.length>0&&(a=a.map(t=>t.barcode&&"-"!==t.barcode?t:eU(t,e.products))),t({type:"PROCESS_RETURNS",payload:a}),T([]),D(!1),p("".concat(a.length,"개 항목을 입고 처리했습니다."))},onDeleteSelected:()=>{if(0===P.length){p("삭제할 항목을 선택해주세요.");return}d(!0),p("".concat(P.length,"개 항목을 삭제 중입니다...")),setTimeout(()=>{let a=e.pendingReturns.filter((e,t)=>!P.includes(t));t({type:"SET_RETURNS",payload:{...e,pendingReturns:a}}),T([]),d(!1),p("".concat(P.length,"개 항목이 삭제되었습니다."))},1e3)},onRematchSelected:()=>{if(0===P.length){p("재매칭할 항목을 선택해주세요.");return}ee(!0)},onItemSelect:(t,a)=>{let r=e.pendingReturns.findIndex(e=>e.id===t.id);a?T(e=>[...e,r]):T(e=>e.filter(e=>e!==r))},PendingItemsTable:t=>{let{items:a}=t,o=eB(a);return(0,r.jsxs)("table",{className:"pending-returns-table min-w-full divide-y divide-gray-200 ".concat(es.autoTextSize.enabled?"auto-text-size-enabled":""),children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"col-actions px-1 py-1 text-center text-2xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsx)("input",{type:"checkbox",checked:E,onChange:ej,className:"w-4 h-4"})}),(0,r.jsx)("th",{className:"col-customer-name px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"고객명"}),(0,r.jsx)("th",{className:"col-order-number px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"주문번호"}),(0,r.jsx)("th",{className:"col-product-name px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"사입상품명"}),(0,r.jsx)("th",{className:"col-option-name px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"옵션"}),(0,r.jsx)("th",{className:"col-quantity px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"수량"}),(0,r.jsx)("th",{className:"col-return-reason px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"반품사유"}),(0,r.jsx)("th",{className:"col-tracking-number px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"수거송장번호"}),(0,r.jsx)("th",{className:"col-barcode px-1 py-1 text-left text-2xs font-medium text-gray-500 uppercase tracking-wider",children:"바코드번호"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((t,o)=>{let n=t.items[0],s=a.findIndex(e=>e.id===n.id),c=P.includes(s);return(0,r.jsxs)("tr",{className:"hover:bg-blue-50 ".concat(eS(n,s,a)),children:[(0,r.jsx)("td",{className:"col-actions px-1 py-1",children:(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)("input",{type:"checkbox",checked:c,onChange:e=>{e.target.checked?T(e=>[...e,s]):T(e=>e.filter(e=>e!==s))},className:"w-4 h-4"})})}),(0,r.jsx)("td",{className:"col-customer-name px-1 py-1 whitespace-nowrap overflow-hidden text-ellipsis max-w-[100px]",children:n.customerName}),(0,r.jsx)("td",{className:"col-order-number px-1 py-1 whitespace-nowrap overflow-hidden text-ellipsis",children:n.orderNumber}),(0,r.jsx)("td",{className:"col-product-name px-1 py-1",children:(0,r.jsx)("div",{className:n.barcode?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words line-clamp-2",children:eA(n)})}),(0,r.jsx)("td",{className:"col-option-name px-1 py-1 whitespace-nowrap overflow-hidden text-ellipsis",children:l(n.optionName)}),(0,r.jsx)("td",{className:"col-quantity px-1 py-1 whitespace-nowrap text-center",children:n.quantity}),(0,r.jsx)("td",{className:"col-return-reason px-1 py-1",children:(0,r.jsx)("div",{className:"cursor-pointer ".concat(eC(n.returnReason)?"text-red-500":""," whitespace-nowrap overflow-hidden text-ellipsis max-w-[120px]"),onClick:()=>eC(n.returnReason)&&ev(n),children:eR(n.returnReason)})}),(0,r.jsx)("td",{className:"col-tracking-number px-1 py-1",children:(0,r.jsx)("div",{className:"font-mono text-2xs whitespace-nowrap bg-blue-100 px-1 py-0.5 rounded text-center",children:"no-tracking"===t.trackingNumber?"-":t.trackingNumber})}),(0,r.jsx)("td",{className:"col-barcode px-1 py-1",children:es.barcodeFormat.enabled&&n.barcode&&"-"!==n.barcode?(0,r.jsxs)("div",{className:"barcode-field ".concat(es.barcodeFormat.enabled?"enabled":""),children:[(0,r.jsx)("div",{className:"main-code",children:n.barcode}),(()=>{let t=e.products.find(e=>e.barcode===n.barcode);return t?(0,r.jsxs)("div",{className:"sub-info",children:["(",t.purchaseName," ",t.optionName,")"]}):null})()]}):(0,r.jsxs)("div",{className:"text-2xs",children:[(0,r.jsx)("div",{className:"font-mono font-semibold",children:n.barcode||"-"}),n.barcode&&"-"!==n.barcode&&(()=>{let t=e.products.find(e=>e.barcode===n.barcode);return t?(0,r.jsxs)("div",{className:"main-barcode-info",title:"".concat(t.purchaseName," ").concat(t.optionName),children:["(",t.purchaseName," ",t.optionName,")"]}):null})()]})})]},n.id)})})]})}}),(0,r.jsx)("dialog",{ref:x,className:"modal w-11/12 max-w-5xl p-0 rounded-lg shadow-xl",onClick:e=>{let t=e.currentTarget.getBoundingClientRect();if(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom){e.currentTarget.close();let t=e.currentTarget.id;t&&(eK(e=>e.filter(e=>e!==t)),eq(e=>Math.max(0,e-10)))}},id:"productModal",children:(0,r.jsxs)("div",{className:"modal-box bg-white p-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-4 flex justify-between items-center",children:[(0,r.jsx)("span",{children:"상품 데이터 목록"}),(0,r.jsx)("button",{onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.close()},className:"btn btn-sm btn-circle",children:"✕"})]}),(0,r.jsxs)("div",{className:"mb-4 flex justify-end gap-2",children:[(0,r.jsxs)("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded flex items-center gap-1",onClick:()=>{d(!0),p("상품 데이터 중복 제거 중입니다...");try{let a=e.products||[];console.log("상품 중복 제거 시작: ".concat(a.length,"개"));let r=new Set,o=a.filter(e=>{let t="".concat(e.productName||"","_").concat(e.optionName||"","_").concat(e.barcode||"");return!r.has(t)&&(r.add(t),!0)}),n=a.length-o.length;n>0?(t({type:"SET_RETURNS",payload:{...e,products:o}}),localStorage.setItem("products",JSON.stringify(o)),p("상품 중복 제거 완료: ".concat(n,"개 중복 항목이 제거되었습니다.")),console.log("상품 중복 제거 완료: ".concat(a.length," → ").concat(o.length," (").concat(n,"개 제거)"))):(p("중복된 상품이 없습니다."),console.log("중복된 상품이 없음"))}catch(e){console.error("상품 중복 제거 오류:",e),p("상품 중복 제거 중 오류가 발생했습니다.")}finally{d(!1)}},disabled:!e.products||0===e.products.length,children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),"새로고침 (중복제거)"]}),(0,r.jsx)("button",{className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded",onClick:ek,disabled:!e.products||0===e.products.length,children:"전체 삭제"})]}),e.products&&e.products.length>0?(0,r.jsx)("div",{className:"overflow-x-auto max-h-[70vh]",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300 main-table ".concat(es.autoTextSize.enabled?"auto-text-size-enabled":""),children:[(0,r.jsx)("thead",{className:"sticky top-0 bg-white",children:(0,r.jsxs)("tr",{className:"bg-gray-100",children:[(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-actions",children:"번호"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:"사입상품명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:"상품명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-option-name",children:"옵션명"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-barcode",children:"바코드번호"}),(0,r.jsx)("th",{className:"px-2 py-2 border-x border-gray-300 col-order-number",children:"자체상품코드"})]})}),(0,r.jsx)("tbody",{children:e.products.map((e,t)=>(0,r.jsxs)("tr",{className:"border-t border-gray-300 hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-actions",children:t+1}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:e.purchaseName||"-"}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-product-name",children:e.productName}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-option-name",children:e.optionName||"-"}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 font-mono col-barcode",children:es.barcodeFormat.enabled&&e.barcode&&e.barcode.includes("(")?(0,r.jsxs)("div",{className:"barcode-field ".concat(es.barcodeFormat.enabled?"enabled":""),children:[(0,r.jsx)("div",{className:"main-code",children:e.barcode.split("(")[0].trim()}),(0,r.jsxs)("div",{className:"sub-info",children:["(",e.barcode.split("(")[1]]})]}):e.barcode}),(0,r.jsx)("td",{className:"px-2 py-2 border-x border-gray-300 col-order-number",children:e.zigzagProductCode||"-"})]},e.id))})]})}):(0,r.jsx)("p",{children:"상품 데이터가 없습니다."}),(0,r.jsx)("div",{className:"modal-action mt-6",children:(0,r.jsx)("button",{className:"btn",onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.close()},children:"닫기"})})]})}),G&&Y&&(0,r.jsx)(y,{isOpen:G,onClose:()=>{V(!1),X(null),eq(e=>Math.max(0,e-10))},returnItem:Y,products:e.products||[],onMatch:(a,r)=>{d(!0);let o={...a,barcode:r.barcode,purchaseName:r.purchaseName||r.productName,zigzagProductCode:r.zigzagProductCode||"",customProductCode:r.customProductCode||"",matchType:"manual",matchSimilarity:1,matchedProductName:r.productName};if(console.log("매칭 완료:",{원래상품명:a.productName,매칭된사입상품명:o.purchaseName,바코드:o.barcode}),e.pendingReturns.some(e=>e.id===a.id)){let r=e.pendingReturns.map(e=>e.id===a.id?o:e);t({type:"SET_RETURNS",payload:{...e,pendingReturns:r}}),localStorage.setItem("pendingReturns",JSON.stringify(r))}else{let r=e.completedReturns.map(e=>e.id===a.id?o:e);t({type:"SET_RETURNS",payload:{...e,completedReturns:r}}),localStorage.setItem("completedReturns",JSON.stringify(r))}localStorage.setItem("lastUpdated",new Date().toISOString()),V(!1),d(!1),e.pendingReturns.some(e=>e.id===a.id)||(I([]),M(!1)),p('"'.concat(a.productName,'" 상품이 "').concat(r.purchaseName||r.productName,'"(으)로 매칭되었습니다.'))},zIndex:1e3+eW}),b&&w&&(0,r.jsx)(m,{isOpen:b,onClose:()=>{N(!1),eq(e=>Math.max(0,e-10))},returnItem:w,detailReason:R||"",onSave:ew,setDetailReason:k,zIndex:1e3+eW}),(0,r.jsx)(v,{isOpen:Z,onClose:()=>{ee(!1),T([])},selectedItems:P.map(t=>e.pendingReturns[t]).filter(Boolean),products:e.products||[],onRematch:(a,r)=>{let o=e.pendingReturns.find(e=>e.id===a);if(!o)return;let n=e.products.find(e=>e.barcode===r);if(!n)return;let l={...o,barcode:r,purchaseName:n.purchaseName||n.productName,zigzagProductCode:n.zigzagProductCode||"",matchType:"수동재매칭",matchSimilarity:1,matchedProductName:n.productName,matchedProductOption:n.optionName},s=e.pendingReturns.map(e=>e.id===a?l:e);t({type:"SET_RETURNS",payload:{...e,pendingReturns:s}}),localStorage.setItem("pendingReturns",JSON.stringify(s)),localStorage.setItem("lastUpdated",new Date().toISOString()),p('"'.concat(o.purchaseName,'" 항목이 "').concat(n.productName,'" (').concat(r,")로 재매칭되었습니다."))}}),et&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",style:{zIndex:1e3+eW},onClick:()=>ea(!1),children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 max-w-md p-6",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-4 flex justify-between items-center",children:[(0,r.jsx)("span",{children:"날짜 변경"}),(0,r.jsx)("button",{onClick:()=>ea(!1),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:"✕"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["선택된 ",O.length,"개 항목의 날짜를 변경할 수 있습니다."]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"새로운 날짜 선택"}),(0,r.jsx)("input",{type:"date",value:er,onChange:e=>eo(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded",onClick:()=>ea(!1),children:"취소"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded",onClick:()=>er&&tl(er),disabled:!er,children:"날짜 변경"})]})]})}),en&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",style:{zIndex:1e3+eW},onClick:()=>el(!1),children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 max-w-2xl p-6",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-4 flex justify-between items-center",children:[(0,r.jsx)("span",{children:"표 및 텍스트 크기 조정"}),(0,r.jsx)("button",{onClick:()=>el(!1),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:"✕"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-blue-600",children:"팝업 크기"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["팝업 너비: ",es.popupWidth,"vw"]}),(0,r.jsx)("input",{type:"range",min:"50",max:"120",step:"1",value:es.popupWidth,onChange:e=>eg("popupWidth",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["팝업 높이: ",es.popupHeight,"vh"]}),(0,r.jsx)("input",{type:"range",min:"40",max:"90",step:"0.5",value:es.popupHeight,onChange:e=>eg("popupHeight",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-green-600",children:"텍스트 크기"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["입고전 반품목록 테이블 폰트: ",es.popupTableFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.5",max:"2.5",step:"0.1",value:es.popupTableFontSize,onChange:e=>eg("popupTableFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["입고전 반품목록 바코드 폰트: ",es.popupBarcodeFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.3",max:"1.5",step:"0.1",value:es.popupBarcodeFontSize,onChange:e=>eg("popupBarcodeFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["메인 화면 테이블 폰트: ",es.mainTableFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.5",max:"2.5",step:"0.1",value:es.mainTableFontSize,onChange:e=>eg("mainTableFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["메인 화면 바코드 폰트: ",es.mainBarcodeFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.3",max:"1.5",step:"0.1",value:es.mainBarcodeFontSize,onChange:e=>eg("mainBarcodeFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-purple-600",children:"셀 설정"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["입고전 반품목록 셀 패딩: ",es.popupCellPadding,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.1",max:"1.0",step:"0.1",value:es.popupCellPadding,onChange:e=>eg("popupCellPadding",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["입고전 반품목록 줄 높이: ",es.popupLineHeight]}),(0,r.jsx)("input",{type:"range",min:"1.0",max:"2.0",step:"0.1",value:es.popupLineHeight,onChange:e=>eg("popupLineHeight",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["메인 화면 셀 패딩: ",es.mainCellPadding,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.1",max:"1.0",step:"0.1",value:es.mainCellPadding,onChange:e=>eg("mainCellPadding",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["메인 화면 줄 높이: ",es.mainLineHeight]}),(0,r.jsx)("input",{type:"range",min:"1.0",max:"2.0",step:"0.1",value:es.mainLineHeight,onChange:e=>eg("mainLineHeight",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-orange-600",children:"미리보기"}),(0,r.jsxs)("div",{className:"border rounded p-3 bg-gray-50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"현재 설정값"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:["팝업: ",es.popupWidth,"vw \xd7 ",es.popupHeight,"vh"]}),(0,r.jsxs)("div",{children:["입고전 반품목록 테이블 폰트: ",es.popupTableFontSize,"rem"]}),(0,r.jsxs)("div",{children:["입고전 반품목록 바코드 폰트: ",es.popupBarcodeFontSize,"rem"]}),(0,r.jsxs)("div",{children:["입고전 반품목록 셀 패딩: ",es.popupCellPadding,"rem"]}),(0,r.jsxs)("div",{children:["입고전 반품목록 줄 높이: ",es.popupLineHeight]}),(0,r.jsxs)("div",{children:["메인 화면 테이블 폰트: ",es.mainTableFontSize,"rem"]}),(0,r.jsxs)("div",{children:["메인 화면 바코드 폰트: ",es.mainBarcodeFontSize,"rem"]}),(0,r.jsxs)("div",{children:["메인 화면 셀 패딩: ",es.mainCellPadding,"rem"]}),(0,r.jsxs)("div",{children:["메인 화면 줄 높이: ",es.mainLineHeight]}),(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[(0,r.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"컬럼 너비:"}),(0,r.jsxs)("div",{children:["고객명: ",es.columnWidths.customerName,"px"]}),(0,r.jsxs)("div",{children:["주문번호: ",es.columnWidths.orderNumber,"px"]}),(0,r.jsxs)("div",{children:["상품명: ",es.columnWidths.productName,"px"]}),(0,r.jsxs)("div",{children:["옵션명: ",es.columnWidths.optionName,"px"]}),(0,r.jsxs)("div",{children:["수량: ",es.columnWidths.quantity,"px"]}),(0,r.jsxs)("div",{children:["반품사유: ",es.columnWidths.returnReason,"px"]}),(0,r.jsxs)("div",{children:["송장번호: ",es.columnWidths.trackingNumber,"px"]}),(0,r.jsxs)("div",{children:["바코드: ",es.columnWidths.barcode,"px"]}),(0,r.jsxs)("div",{children:["액션: ",es.columnWidths.actions,"px"]})]}),(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[(0,r.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"자동 텍스트 크기:"}),(0,r.jsxs)("div",{children:["활성화: ",es.autoTextSize.enabled?"예":"아니오"]}),(0,r.jsxs)("div",{children:["최소/최대: ",es.autoTextSize.minFontSize,"rem / ",es.autoTextSize.maxFontSize,"rem"]}),(0,r.jsxs)("div",{children:["오버플로우 방지: ",es.autoTextSize.adjustForOverflow?"예":"아니오"]})]}),(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[(0,r.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"바코드번호 형식:"}),(0,r.jsxs)("div",{children:["활성화: ",es.barcodeFormat.enabled?"예":"아니오"]}),(0,r.jsxs)("div",{children:["메인/서브: ",es.barcodeFormat.mainCodeSize,"rem / ",es.barcodeFormat.subInfoSize,"rem"]}),(0,r.jsxs)("div",{children:["줄 간격: ",es.barcodeFormat.lineHeight]})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-blue-600",children:"컬럼 정렬 설정"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"고객명 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.customerName,onChange:e=>ex("customerName",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"주문번호 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.orderNumber,onChange:e=>ex("orderNumber",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.productName,onChange:e=>ex("productName",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"옵션명 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.optionName,onChange:e=>ex("optionName",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"수량 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.quantity,onChange:e=>ex("quantity",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"반품사유 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.returnReason,onChange:e=>ex("returnReason",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"송장번호 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.trackingNumber,onChange:e=>ex("trackingNumber",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"바코드 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.barcode,onChange:e=>ex("barcode",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"액션 버튼 정렬"}),(0,r.jsxs)("select",{value:es.columnAlignment.actions,onChange:e=>ex("actions",e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"left",children:"왼쪽"}),(0,r.jsx)("option",{value:"center",children:"가운데"}),(0,r.jsx)("option",{value:"right",children:"오른쪽"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-red-600",children:"컬럼 너비 설정 (px)"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["고객명 너비: ",es.columnWidths.customerName,"px"]}),(0,r.jsx)("input",{type:"range",min:"80",max:"200",step:"5",value:es.columnWidths.customerName,onChange:e=>eb("customerName",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["주문번호 너비: ",es.columnWidths.orderNumber,"px"]}),(0,r.jsx)("input",{type:"range",min:"80",max:"200",step:"5",value:es.columnWidths.orderNumber,onChange:e=>eb("orderNumber",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["상품명 너비: ",es.columnWidths.productName,"px"]}),(0,r.jsx)("input",{type:"range",min:"120",max:"300",step:"10",value:es.columnWidths.productName,onChange:e=>eb("productName",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["옵션명 너비: ",es.columnWidths.optionName,"px"]}),(0,r.jsx)("input",{type:"range",min:"80",max:"200",step:"5",value:es.columnWidths.optionName,onChange:e=>eb("optionName",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["수량 너비: ",es.columnWidths.quantity,"px"]}),(0,r.jsx)("input",{type:"range",min:"60",max:"120",step:"5",value:es.columnWidths.quantity,onChange:e=>eb("quantity",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["반품사유 너비: ",es.columnWidths.returnReason,"px"]}),(0,r.jsx)("input",{type:"range",min:"100",max:"250",step:"10",value:es.columnWidths.returnReason,onChange:e=>eb("returnReason",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["송장번호 너비: ",es.columnWidths.trackingNumber,"px"]}),(0,r.jsx)("input",{type:"range",min:"80",max:"200",step:"5",value:es.columnWidths.trackingNumber,onChange:e=>eb("trackingNumber",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["바코드 너비: ",es.columnWidths.barcode,"px"]}),(0,r.jsx)("input",{type:"range",min:"120",max:"300",step:"10",value:es.columnWidths.barcode,onChange:e=>eb("barcode",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["액션 버튼 너비: ",es.columnWidths.actions,"px"]}),(0,r.jsx)("input",{type:"range",min:"80",max:"200",step:"5",value:es.columnWidths.actions,onChange:e=>eb("actions",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-indigo-600",children:"자동 텍스트 크기 조정"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"autoTextSizeEnabled",checked:es.autoTextSize.enabled,onChange:e=>eN("enabled",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"autoTextSizeEnabled",className:"text-sm font-medium text-gray-700",children:"자동 텍스트 크기 조정 활성화"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["최소 폰트 크기: ",es.autoTextSize.minFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.3",max:"1.0",step:"0.1",value:es.autoTextSize.minFontSize,onChange:e=>eN("minFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["최대 폰트 크기: ",es.autoTextSize.maxFontSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"1.0",max:"2.0",step:"0.1",value:es.autoTextSize.maxFontSize,onChange:e=>eN("maxFontSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"adjustForOverflow",checked:es.autoTextSize.adjustForOverflow,onChange:e=>eN("adjustForOverflow",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"adjustForOverflow",className:"text-sm font-medium text-gray-700",children:"오버플로우 방지"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-md mb-3 text-teal-600",children:"바코드번호 필드 형식"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"barcodeFormatEnabled",checked:es.barcodeFormat.enabled,onChange:e=>ef("enabled",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"barcodeFormatEnabled",className:"text-sm font-medium text-gray-700",children:"바코드번호 특별 형식 활성화"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["메인 코드 크기: ",es.barcodeFormat.mainCodeSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.8",max:"1.5",step:"0.1",value:es.barcodeFormat.mainCodeSize,onChange:e=>ef("mainCodeSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["서브 정보 크기: ",es.barcodeFormat.subInfoSize,"rem"]}),(0,r.jsx)("input",{type:"range",min:"0.5",max:"1.0",step:"0.1",value:es.barcodeFormat.subInfoSize,onChange:e=>ef("subInfoSize",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["줄 간격: ",es.barcodeFormat.lineHeight]}),(0,r.jsx)("input",{type:"range",min:"0.8",max:"1.5",step:"0.1",value:es.barcodeFormat.lineHeight,onChange:e=>ef("lineHeight",Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded",onClick:()=>el(!1),children:"취소"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:()=>{let e=document.documentElement;e.style.setProperty("--popup-width","".concat(es.popupWidth,"vw")),e.style.setProperty("--popup-height","".concat(es.popupHeight,"vh")),e.style.setProperty("--popup-table-font-size","".concat(es.popupTableFontSize,"rem")),e.style.setProperty("--popup-barcode-font-size","".concat(es.popupBarcodeFontSize,"rem")),e.style.setProperty("--popup-cell-padding","".concat(es.popupCellPadding,"rem")),e.style.setProperty("--popup-line-height",es.popupLineHeight.toString()),e.style.setProperty("--main-table-font-size","".concat(es.mainTableFontSize,"rem")),e.style.setProperty("--main-barcode-font-size","".concat(es.mainBarcodeFontSize,"rem")),e.style.setProperty("--main-cell-padding","".concat(es.mainCellPadding,"rem")),e.style.setProperty("--main-line-height",es.mainLineHeight.toString()),Object.entries(es.columnAlignment).forEach(t=>{let[a,r]=t;e.style.setProperty("--column-".concat(a,"-alignment"),r)}),Object.entries(es.columnWidths).forEach(t=>{let[a,r]=t;e.style.setProperty("--column-".concat(a,"-width"),"".concat(r,"px"))}),Object.entries(es.autoTextSize).forEach(t=>{let[a,r]=t;e.style.setProperty("--auto-text-size-".concat("enabled"===a?"enabled":"minFontSize"===a?"minFontSize":"maxFontSize"===a?"maxFontSize":"adjustForOverflow"===a?"adjustForOverflow":a),String(r))}),Object.entries(es.barcodeFormat).forEach(t=>{let[a,r]=t;e.style.setProperty("--barcode-format-".concat("enabled"===a?"enabled":"mainCodeSize"===a?"mainCodeSize":"subInfoSize"===a?"subInfoSize":"lineHeight"===a?"lineHeight":a),String(r))}),localStorage.setItem("tableSettings",JSON.stringify(es)),es.autoTextSize.enabled&&setTimeout(ey,100),p("표 설정이 적용되었습니다. 설정을 저장했습니다."),el(!1)},children:"설정 적용"})]})]})})]})}},2533:(e,t,a)=>{"use strict";a.d(t,{b:()=>i,m:()=>c});var r=a(7437),o=a(2265);let n={pendingReturns:[],completedReturns:[],products:[]};function l(e,t){switch(t.type){case"SET_RETURNS":return t.payload;case"ADD_RETURNS":return{...e,pendingReturns:[...e.pendingReturns,...t.payload]};case"ADD_PRODUCTS":return{...e,products:[...e.products,...t.payload]};case"SET_PRODUCTS":return{...e,products:t.payload};case"PROCESS_RETURNS":let a=t.payload,r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate());o.setHours(0,0,0,0);let n=a.map(e=>({...e,status:"COMPLETED",completedAt:o})),l=e.pendingReturns.filter(e=>!a.some(t=>t.id===e.id));return{...e,pendingReturns:l,completedReturns:[...n,...e.completedReturns]};case"UPDATE_RETURN_REASON":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?{...e,detailReason:t.payload.detailReason,returnReason:e.returnReason+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):"")}:e),completedReturns:e.completedReturns.map(e=>e.id===t.payload.id?{...e,detailReason:t.payload.detailReason,returnReason:e.returnReason.includes("(")?e.returnReason.split("(")[0].trim()+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):""):e.returnReason+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):"")}:e)};case"UPDATE_RETURN_ITEM":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?t.payload:e)};case"MATCH_PRODUCTS":let s=e.pendingReturns.map(t=>{if(t.barcode&&"-"!==t.barcode)return t;let a=e=>{if(!t.optionName||0===e.length)return e[0]||null;let a=t.optionName.toLowerCase().trim(),r=e.find(e=>e.optionName&&e.optionName.toLowerCase().trim()===a);if(r)return r;let o=null,n=.7;for(let t of e)if(t.optionName){let e=t.optionName.toLowerCase().trim();(e.includes(a)||a.includes(e))&&.9>n&&(n=.9,o=t)}if(o)return o;let l=null,s=0,c=e=>e.replace(/[\[\]]/g,"").split(/[,\/:\-\s]+/).map(e=>e.trim()).filter(e=>e.length>0&&"선택"!==e),i=c(a);for(let t of e)if(t.optionName){let e=c(t.optionName.toLowerCase().trim()),a=i.filter(t=>e.some(e=>!!(e===t||t.length>=3&&e.includes(t)||e.length>=3&&t.includes(e))));if(a.length>0){let r=a.length/Math.max(i.length,e.length)*.8+a.length/i.length*.2;r>s&&r>=.4&&(s=r,l=t)}}return l||null};if(t.zigzagProductCode&&"-"!==t.zigzagProductCode){let r=e.products.filter(e=>e.zigzagProductCode&&e.zigzagProductCode===t.zigzagProductCode);if(r.length>0){let e=a(r);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,matchSimilarity:1,matchType:"자체상품코드 정확 매칭"}}let o=null,n=t.zigzagProductCode.toLowerCase().trim();for(let t of e.products)if(t.purchaseName&&"string"==typeof t.purchaseName){let e=t.purchaseName.toLowerCase().trim();if(e.includes(n)||n.includes(e))(!o||.95>o.similarity)&&(o={product:t,similarity:.95,matchType:"자체상품코드-사입명 포함관계"});else{let a=Math.min(n.length,e.length),r=Math.max(n.length,e.length);if(a>0&&r>0){let l=0;for(let t=0;t<a;t++)n[t]===e[t]&&l++;let s=l/r;s>.4&&(!o||s>o.similarity)&&(o={product:t,similarity:s,matchType:"자체상품코드-사입명 유사도"})}}}if(o&&o.similarity>.5)return{...t,barcode:o.product.barcode||"",purchaseName:o.product.purchaseName||o.product.productName,zigzagProductCode:o.product.zigzagProductCode||t.zigzagProductCode,customProductCode:o.product.customProductCode||o.product.zigzagProductCode||"",matchSimilarity:o.similarity,matchType:o.matchType}}if(t.productName){let r=e.products.filter(e=>e.productName&&"string"==typeof e.productName&&"string"==typeof t.productName&&e.productName.toLowerCase().trim()===t.productName.toLowerCase().trim());if(r.length>0){let e=a(r);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:1,matchType:"상품명 완전일치"}}let o=e.products.filter(e=>e.purchaseName&&"string"==typeof e.purchaseName&&"string"==typeof t.productName&&e.purchaseName.toLowerCase().trim()===t.productName.toLowerCase().trim());if(o.length>0){let e=a(o);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:1,matchType:"사입상품명 완전일치"}}let n=[];for(let a of e.products){if(a.productName&&t.productName&&"string"==typeof a.productName&&"string"==typeof t.productName){let e=a.productName.toLowerCase(),r=t.productName.toLowerCase();(e.includes(r)||r.includes(e))&&n.push(a)}if(a.purchaseName&&t.productName&&"string"==typeof a.purchaseName&&"string"==typeof t.productName){let e=a.purchaseName.toLowerCase(),r=t.productName.toLowerCase();(e.includes(r)||r.includes(e))&&n.push(a)}}if(n.length>0){let e=a(n);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:.7,matchType:"상품명 포함관계"}}}return t});return{...e,pendingReturns:s};case"REMOVE_PENDING_RETURNS":{let a=t.payload;return{...e,pendingReturns:e.pendingReturns.filter((e,t)=>!a.includes(t))}}case"REMOVE_PENDING_RETURN":{let a=t.payload.id;return{...e,pendingReturns:e.pendingReturns.filter(e=>e.id!==a)}}case"ADD_COMPLETED_RETURN":if(e.completedReturns.some(e=>e.id===t.payload.id))return e;return{...e,completedReturns:[...e.completedReturns,t.payload]};case"UPDATE_PENDING_RETURN":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?t.payload:e)};default:return e}}let s=(0,o.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,o.useReducer)(l,n);return(0,r.jsx)(s.Provider,{value:{returnState:a,dispatch:c},children:t})}function i(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useReturnState must be used within a ReturnStateProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[425,130,215,744],()=>t(4856)),_N_E=e.O()}]);