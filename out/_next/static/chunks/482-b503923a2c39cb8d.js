"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[482],{8984:(e,t,r)=>{r.d(t,{GlobalModalContainer:()=>i,J:()=>u});var a=r(7437),o=r(2265);let n=(0,o.createContext)(null),d=1e4,i=e=>{let{children:t}=e,[r,i]=(0,o.useState)([]),u=(0,o.useCallback)((e,t)=>{d+=10,i(r=>[...r.filter(t=>t.id!==e),{id:e,component:t,zIndex:d}]),console.log("모달 추가: ".concat(e,", z-index: ").concat(d))},[]),l=(0,o.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e)),console.log("모달 제거: ".concat(e))},[]),c=(0,o.useCallback)(e=>{d+=10,i(t=>{let r=t.find(t=>t.id===e);return r?[...t.filter(t=>t.id!==e),{...r,zIndex:d}]:t}),console.log("모달 최상위로 이동: ".concat(e,", z-index: ").concat(d))},[]);return(0,a.jsxs)(n.Provider,{value:{addModal:u,removeModal:l,bringToFront:c},children:[t,r.map(e=>(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:e.zIndex,pointerEvents:"auto"},children:e.component},e.id))]})},u=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useGlobalModal must be used within GlobalModalContainer");return e}},2533:(e,t,r)=>{r.d(t,{b:()=>l,m:()=>u});var a=r(7437),o=r(2265);let n={pendingReturns:[],completedReturns:[],products:[]};function d(e,t){switch(t.type){case"SET_RETURNS":return t.payload;case"ADD_RETURNS":return{...e,pendingReturns:[...e.pendingReturns,...t.payload]};case"ADD_PRODUCTS":return{...e,products:[...e.products,...t.payload]};case"SET_PRODUCTS":return{...e,products:t.payload};case"PROCESS_RETURNS":let r=t.payload,a=new Date,o=new Date(a.getFullYear(),a.getMonth(),a.getDate());o.setHours(0,0,0,0);let n=r.map(e=>({...e,status:"COMPLETED",completedAt:o})),d=e.pendingReturns.filter(e=>!r.some(t=>t.id===e.id));return{...e,pendingReturns:d,completedReturns:[...n,...e.completedReturns]};case"UPDATE_RETURN_REASON":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?{...e,detailReason:t.payload.detailReason,returnReason:e.returnReason+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):"")}:e),completedReturns:e.completedReturns.map(e=>e.id===t.payload.id?{...e,detailReason:t.payload.detailReason,returnReason:e.returnReason.includes("(")?e.returnReason.split("(")[0].trim()+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):""):e.returnReason+(t.payload.detailReason?" (".concat(t.payload.detailReason,")"):"")}:e)};case"UPDATE_RETURN_ITEM":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?t.payload:e)};case"MATCH_PRODUCTS":let i=e.pendingReturns.map(t=>{if(t.barcode&&"-"!==t.barcode)return t;let r=e=>{if(!t.optionName||0===e.length)return e[0]||null;let r=t.optionName.toLowerCase().trim(),a=e.find(e=>e.optionName&&e.optionName.toLowerCase().trim()===r);if(a)return a;let o=null,n=.7;for(let t of e)if(t.optionName){let e=t.optionName.toLowerCase().trim();(e.includes(r)||r.includes(e))&&.9>n&&(n=.9,o=t)}if(o)return o;let d=null,i=0,u=e=>e.replace(/[\[\]]/g,"").split(/[,\/:\-\s]+/).map(e=>e.trim()).filter(e=>e.length>0&&"선택"!==e),l=u(r);for(let t of e)if(t.optionName){let e=u(t.optionName.toLowerCase().trim()),r=l.filter(t=>e.some(e=>!!(e===t||t.length>=3&&e.includes(t)||e.length>=3&&t.includes(e))));if(r.length>0){let a=r.length/Math.max(l.length,e.length)*.8+r.length/l.length*.2;a>i&&a>=.4&&(i=a,d=t)}}return d||null};if(t.zigzagProductCode&&"-"!==t.zigzagProductCode){let a=e.products.filter(e=>e.zigzagProductCode&&e.zigzagProductCode===t.zigzagProductCode);if(a.length>0){let e=r(a);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,matchSimilarity:1,matchType:"자체상품코드 정확 매칭"}}let o=null,n=t.zigzagProductCode.toLowerCase().trim();for(let t of e.products)if(t.purchaseName&&"string"==typeof t.purchaseName){let e=t.purchaseName.toLowerCase().trim();if(e.includes(n)||n.includes(e))(!o||.95>o.similarity)&&(o={product:t,similarity:.95,matchType:"자체상품코드-사입명 포함관계"});else{let r=Math.min(n.length,e.length),a=Math.max(n.length,e.length);if(r>0&&a>0){let d=0;for(let t=0;t<r;t++)n[t]===e[t]&&d++;let i=d/a;i>.4&&(!o||i>o.similarity)&&(o={product:t,similarity:i,matchType:"자체상품코드-사입명 유사도"})}}}if(o&&o.similarity>.5)return{...t,barcode:o.product.barcode||"",purchaseName:o.product.purchaseName||o.product.productName,zigzagProductCode:o.product.zigzagProductCode||t.zigzagProductCode,customProductCode:o.product.customProductCode||o.product.zigzagProductCode||"",matchSimilarity:o.similarity,matchType:o.matchType}}if(t.productName){let a=e.products.filter(e=>e.productName&&"string"==typeof e.productName&&"string"==typeof t.productName&&e.productName.toLowerCase().trim()===t.productName.toLowerCase().trim());if(a.length>0){let e=r(a);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:1,matchType:"상품명 완전일치"}}let o=e.products.filter(e=>e.purchaseName&&"string"==typeof e.purchaseName&&"string"==typeof t.productName&&e.purchaseName.toLowerCase().trim()===t.productName.toLowerCase().trim());if(o.length>0){let e=r(o);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:1,matchType:"사입상품명 완전일치"}}let n=[];for(let r of e.products){if(r.productName&&t.productName&&"string"==typeof r.productName&&"string"==typeof t.productName){let e=r.productName.toLowerCase(),a=t.productName.toLowerCase();(e.includes(a)||a.includes(e))&&n.push(r)}if(r.purchaseName&&t.productName&&"string"==typeof r.purchaseName&&"string"==typeof t.productName){let e=r.purchaseName.toLowerCase(),a=t.productName.toLowerCase();(e.includes(a)||a.includes(e))&&n.push(r)}}if(n.length>0){let e=r(n);if(e)return{...t,barcode:e.barcode||"",purchaseName:e.purchaseName||e.productName,zigzagProductCode:e.zigzagProductCode||"",matchSimilarity:.7,matchType:"상품명 포함관계"}}}return t});return{...e,pendingReturns:i};case"REMOVE_PENDING_RETURNS":{let r=t.payload;return{...e,pendingReturns:e.pendingReturns.filter((e,t)=>!r.includes(t))}}case"REMOVE_PENDING_RETURN":{let r=t.payload.id;return{...e,pendingReturns:e.pendingReturns.filter(e=>e.id!==r)}}case"ADD_COMPLETED_RETURN":if(e.completedReturns.some(e=>e.id===t.payload.id))return e;return{...e,completedReturns:[...e.completedReturns,t.payload]};case"UPDATE_PENDING_RETURN":return{...e,pendingReturns:e.pendingReturns.map(e=>e.id===t.payload.id?t.payload:e)};default:return e}}let i=(0,o.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,o.useReducer)(d,n);return(0,a.jsx)(i.Provider,{value:{returnState:r,dispatch:u},children:t})}function l(){let e=(0,o.useContext)(i);if(void 0===e)throw Error("useReturnState must be used within a ReturnStateProvider");return e}}}]);